- id: slu
  title: "slu: Tool, ktery mi zjednodusuje praci"
  date: 4. 9. 2021
  ad: kubernetes
  tags:
    - tooling
    - go
    - devops
  perex: |
    Kazdy resime nejake rutijni tasky, ktere si chceme nejak zjednodusit. Kazdy to dela jinak, nekdo pouziva aliasy, nekdo si pise tooling v bash scriptech a nekdo treba Python. Nech utilitek je vetsinou hodne a jsou hodne ruznorode. Ja jsem se po nejakem case michani bash aliasu, Bash a Python skriptu jsem se rozhodl pro prepsani do jednoho Go toolu a nelituji.
  content: |
    Kazdy resime nejake rutijni tasky, ktere si chceme nejak zjednodusit. Kazdy to dela jinak, nekdo pouziva aliasy, nekdo si pise tooling v bash scriptech a nekdo treba Python. Nech utilitek je vetsinou hodne a jsou hodne ruznorode. Ja jsem se po nejakem case michani bash aliasu, Bash a Python skriptu jsem se rozhodl pro prepsani do jednoho Go toolu a nelituji.

    Kdyz jsem se rozhodoval ze napisu tool, bylo jasne ze to bude open source a ze chci aby to mohlo pouzivat vice lidi a abych si mohl zjednodusovat praci na klientskych projektech. Uz me nebavilo porad vytvaret a mazat databaze v CI pomoci bash scriptu, nebo zjistovat token s ServiceAccountu v Kubernetes pomoci 2 sub shellu a nekolik pipes.

    ## Proc v Go

    Kdyz jsem se rozhodoval pro technologii, mel jsem tyto pozadavky:

    - Multiplatformni
    - Jednoduchy na vyvoj
    - Malo zavislosti

    Mam na vyber asi mezi bashem (je vsude), Pythonem (muzu ho nainstalovat vsude) a Go (staticke binarky). Pokud ale vezmu druhy pozadavek, psani v Bashi je peklo, pokud se nejedna o sadu prikazu, ktere je potreba vykonat po sobe.

    Rozhodoval jsem se mezi Go a Pythonem. S Pythonem mam mnohem vetsi zkusenosti nez s Go, ale opriti Go ma 2 nevyhody. Za prve, potrebuju mit nainstalovany Python a za druhe, potrebuju mit nainstalovane knihovny. Neni to tak hrozne, ale porad stahnout jednu binarku, ktera umi vsechno je mnohem jednodussi.

    Navice existuje skvely tool [GoReleaser](https://goreleaser.com), ktery se stara o build a distribuci aplikace. A to uplne skvele, vcetne vytvareni brew balicku.

    ## CLI pomoci knihovny Cobra

    V Go je jeste jedna skvela vec, a to je knihovna [Cobra](https://github.com/spf13/cobra). Pomoci ni se daji delat CLI tooly velmi jednoduse, vcetne autocomplete a generovani dokumentace.

    ## slu: SikaLabs Utils

    Tooling jsem pojmenoval `slu`, at je to hezky kratke. V jeho subcommandech je potom pestra smes nastroju, ktere mi zjednodusuji vyvoj i praci s infrastrukturou.

    ## Instalace slu

    Diky GoReleaseru je distribuce a instalace jednoducha.

    #### Instalace na Macu

    Na Macu je instalace jednoducha, staci:

    ```
    brew install sikalabs/tap/slu
    ```

    #### Instalace na Linux AMD64 (pomoci install-slu)

    Na Linuxu staci stahnout binarku, rozbalit ji a dat ji do path. Udelal jsem ale i [install-slu](https://github.com/sikalabs/install-slu) tool, ktery jednou nainstaluju a pak jim muzu jednoduse upgradovat verze `slu`.

    ```bash
    VERSION=v0.1.0 && \
    OS=linux && \
    ARCH=amd64 && \
    BIN=install-slu && \
    curl -L https://github.com/sikalabs/${BIN}/releases/download/${VERSION}/${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz -o ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    tar -xvzf ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    rm ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    mv ${BIN} /usr/local/bin/
    ```

    Pak uz staci jen

    ```
    install-slu i
    ```

    a je to.


    #### Instalace na Linux AMD64 (na primo)

    Samozrejme muzeme `slu` nainstalovat primo pomoci:

    ```bash
    VERSION=v0.13.0 && \
    OS=linux && \
    ARCH=amd64 && \
    BIN=slu && \
    curl -L https://github.com/sikalabs/${BIN}/releases/download/${VERSION}/${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz -o ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    tar -xvzf ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    rm ${BIN}_${VERSION}_${OS}_${ARCH}.tar.gz && \
    mv ${BIN} /usr/local/bin/
    ```

    ## Ukazka pouziti

    Kdyz si dnes vypisu help, jsou tam tyto subcommandy:

    ```
    ondrej@sika-mac:~$ slu --help
    SikaLabs Utils, v0.13.0

    Usage:
      slu [command]

    Available Commands:
      completion       generate the autocompletion script for the specified shell
      expand           Expand environment variables in files and strings
      file-templates   Create common files from templates
      generate-docs    Generate Markdown docs
      gitlab-ci        Utils for Gitlab CI
      go-code          Utils for writing Go code
      help             Help about any command
      install-bin      Install Binary
      install-bin-tool Install preconfigured binary tool like Terraform, Vault, ...
      ip               Get my current IP address (using checkip.amazonaws.com)
      k8s              Utils for Kubernetes
      mysql            MySQL Utils
      postgres         Postgres Utils
      proxy            Proxy Utils
      tls              TLS Utils
      version          Prints version

    Flags:
      -h, --help   help for slu
          --json   Formatu output to JSON

    Use "slu [command] --help" for more information about a command.
    ```

    K dnesnimu dni `slu` obsahuje tooling pro variable expansion, praci s TLS certifikaty, ziskani IP, proxy, ...

    Pojdme si ukazat alespon nejake ukazky, vice urcite bude v nasledujicich poskytovatelích.

    #### Get public IP address

    [docs](https://github.com/sikalabs/slu-cli-docs/blob/master/slu_ip.md)

    ```
    ondrej@sika-mac:~$ slu ip
    111.44.56.39
    ondrej@sika-mac:~$
    ```

    #### Create Postgres Database

    [docs](https://github.com/sikalabs/slu-cli-docs/blob/master/slu_postgres_create.md)

    ```
    ondrej@sika-mac:~$ slu postgres -H localhost -P 5432 -u postgres -p pg create -n foo
    ondrej@sika-mac:~$
    ```

    ### Version bump in Go code

    [docs](https://github.com/sikalabs/slu-cli-docs/blob/master/slu_go-code_version-bump.md)

    ```
    ondrej@sika-mac:~$ slu go-code version-bump -v 0.33.1 -t
    ondrej@sika-mac:~$
    ```

    ### Install Terraform

    [docs](https://github.com/sikalabs/slu-cli-docs/blob/master/slu_install-bin-tool_terraform.md)

    ```
    ondrej@sika-mac:~$ slu install-bin-tool terraform
    ondrej@sika-mac:~$
    ```

    ## Zaver

    Zdrojove kody jsou samozrejme na Githubu:

    - slu - https://github.com/sikalabs/slu
    - install-slu - https://github.com/sikalabs/install-slu

    Dokumentace je take na Githubu v repozitari [sikalabs/slu-cli-docs](https://github.com/sikalabs/slu-cli-docs/blob/master/slu.md#slu).

    Budu rad, kdyz Vam tool ulehci praci, dejte mi vedet na Twitteru [@ondrejsika](https://twitter.com/ondrejsika) jak se Vam slu libi. Pokud budete chtit neco pridat, poslete issue nebo pull request.


- id: prostredi-pro-vyvojare-spravovane-terraformem
  title: "Dočasné prostředí pro vývojáře spravované Terraformem"
  date: 20. 5. 2021
  ad: terraform
  tags:
    - development
    - terraform
    - cloud
  perex: |
    Team se nám ve firmě zvětšuje, najednou si více lidí potřebuje vytvářet dočasné testovací a vývojové prostředí, jako jsou Kubernetes clustery, virtuální stroje, které musíme nějak rozumě spravovat.
  content: |
    Team se nám ve firmě zvětšuje, najednou si více lidí potřebuje vytvářet dočasné testovací a vývojové prostředí, jako jsou Kubernetes clustery, virtuální stroje, které musíme nějak rozumě spravovat.

    ## Problém

    Kolega Jakub po mě chtěl Kubernetes cluster, aby na něm mohl udělat demo ohledně ArgoCD. Já bych to standardně řešil tak, že bych si spustil moje demo Kubernetes na DigitalOceanu pomocí Terraformu, viz repo [ondrejsika/terraform-demo-k8s](https://github.com/ondrejsika/terraform-demo-k8s).

    Jenže ono to není tak jednoduché. Já už tohle repo naklonované mám, a taky mám připravený i soubor `terraform.auto.tfvars` se správně vyplněnými tokeny do Cloudflare a DigitalOceanu a v zásadě zapnutí toho clusteru mi nezabere žádný čas.

    Ale v případě Jakuba je to něco jiného. On nemá ani repo, ani nastavené values a tokeny k dev infrastruktuře by musel hledat někde ve 1Passwordu. A to už není na chvilku, tenhle setup zabere mnohem víc času a musí se opakovat pro každý nový ukázkový repozitář.

    ## Řešení

    Řešení je mít jednoduchou možnost, jak si spustím resource, který aktuálně potřebuji co nejrychleji. A proto vznikly tyto 2 repozitáře [sikalabs/terraform-module-sikalabs-do-k8s](https://github.com/sikalabs/terraform-module-sikalabs-do-k8s) a `sikalabs/sl-infra-live-dev` (ten druhý je privátní).

    Řešení je v zásadě jednoduché, místo různých stand alone Terraformích repozitářů uděláme moduly co nám jednoduše spustí to co potřebujeme - v našem případě se jedná o Kubernetes cluster včetně load balanceru a DNS záznamu. Ten pak pouze používáme s různou konfigurací v rámci jednoho repozitáře a vše co je v masteru toho `sikalabs/sl-infra-live-dev` repozitáře máme nasazené. Já mám nasazování masterů udělané automaticky pomocí integrace Terraform Cloudu s Githubem, ale i manuální spouštění nebo spouštění pomocí Gitlab CI je OK.

    ## A jak to vlastně vypadá?

    V repozitáři `sikalabs/sl-infra-live-dev` máme nastavený remote backend a v něm všechny tokeny, vývojáři nemusí mít žádné lokální nastavení. Pouze stačí být přihlášen k Terraform Cloudu (pomoci příkazu `terraform login`).

    ```tf
    // _backend.tf

    terraform {
      backend "remote" {
        organization = "sikalabs"
        workspaces {
          name = "sikalabs-live-dev"
        }
      }
    }
    ```

    Protože používáme remote execution, nastavení proměnných pro providery máme v Terraform Cloudu:

    ```tf
    // _providers.tf

    variable "digitalocean_token" {}
    provider "digitalocean" {
      token = var.digitalocean_token
    }

    variable "cloudflare_api_token" {}
    provider "cloudflare" {
      api_token = var.cloudflare_api_token
    }
    ```

    Všechny "globální" soubory mám prefixované podtržítkem, abych je oddělil od těch dočasných, kde si každý vytváří a maže podle potřeby.

    Takže to může vypadat takhle:

    ```tf
    module "ondrejsika_k8s_foo" {
      source              = "sikalabs/sikalabs-do-k8s/module"
      version             = "0.1.0"
      prefix              = "alp"
      cloudflare_zone_id  = local.sikadev_com_zone_id
      digitalocean_region = "fra1"
      kubernetes_version  = "1.20.2-do.0"
      node_size           = "s-2vcpu-4gb"
      node_count          = 3
    }

    module "ondrejsika_k8s_bar" {
      source              = "sikalabs/sikalabs-do-k8s/module"
      version             = "0.1.0"
      prefix              = "alp"
      cloudflare_zone_id  = local.sikadev_com_zone_id
      digitalocean_region = "fra1"
      kubernetes_version  = "1.20.2-do.0"
      node_size           = "s-2vcpu-4gb"
      node_count          = 1
    }

    output "ondrejsika_kubeconfig_foo" {
      value     = module.ondrejsika_k8s_foo.kubeconfig
      sensitive = true
    }

    output "ondrejsika_kubeconfig_bar" {
      value     = module.ondrejsika_k8s_bar.kubeconfig
      sensitive = true
    }
    ```

    Vidíme, že tady používám Terraform modul ([sikalabs/terraform-module-sikalabs-do-k8s](https://github.com/sikalabs/terraform-module-sikalabs-do-k8s)), co mi vytvoří Kubernetes cluster se vším co běžně potřebuju (load balancer a DNS záznamy).

    A pak si každý kdo potřebuje něco v testovacím prostředí pustit pouze přidá své resources a commitne. Když už je nepotřebuje, zase je smaže a opět commitne.

- id: puldenni-workshopy
  hidden: true
  title: "Puldenni workshopy - novy format skoleni"
  date: 1. 1. 2021
  tags:
    - skoleni
  perex: |
    Zkousim novy format mych skoleni / workshopu. Ne kazde tema je tak obsahle, ze je potreba jednodenni skoleni, ale natolik zajimave, ze to chce workshop!
  content: |
    Zkousim novy format mych skoleni / workshopu - puldenni workshopy.

    Ne kazde tema je tak obsahle, ze je potreba jednodenni skoleni, ale natolik zajimave, ze to chce workshop!

    Napadaji me 2 varianty techtoo workshopu:

    - Male ucelene tema
    - Novinky ke skoleni

    Pokusim se je pospsat trosku podrobneji.

    ### Male ucelene tema

    Pokud Vas zajima Cloudflare, Skaffold, Vercel, ... nejsou to temata pro jednodenni skoleni. Jsou moc male nebo specificke. Ale porad stoji za to se s temito nastroji naucit. Den je spousta casu, ale jedno patecni odpoledne venovat rozveji uz nezni tak zle? ;)

    Proto jsem se rozhodl delat tyto mini skoleni na zajimava temata, jen trosku kratsi.

    ### Novinky ke skoleni

    Nastroje se vyvijeji, neco zastarava a nektere workflow se meni. I me skoleni se meni v case. Je zbytecne aby clovek sel na skoleni za rok znovu, i kdyz obcas neni na skodu si pripomenout i zaklady. Cilem kratkeho 4 hodinoveho workshopu je ukazat si co se zmenilo a tak byt porad v obraze.

- id: zaznam-devops-live-20-prometheus-metriky-ve-vlastni-aplikaci
  title: "Záznam DevOps Live #20: Prometheus metriky ve vlastní aplikaci"
  date: 16. 6. 2021
  ad: prometheus
  tags:
    - prometheus
    - devopslive
  perex: |
    Záznanam z dvacátého live streamu: Prometheus metriky ve vlastní aplikaci
  youtube: HdFiLeCaAEY
  content: |
    Pokud se chcete naučit lépe pracovat s Prometheus, doporučuji Vám mé školení [__Prometheus__](/skoleni/prometheus), nebudete litovat.

- id: zaznam-devops-live-19-nebojte-se-git-rebase
  title: "Záznam DevOps Live #19: Nebojte se git rebase"
  date: 2. 6. 2021
  ad: gitlab-ci
  tags:
    - git
    - gitlab
    - github
  perex: |
    Záznam z devatenáctého live streamu: Ovládněte Makefile a zjednodušte si manuální tasky
  youtube: avq2rQW6tHE
  content: |
    Pokud se chcete naučit pracovat kromě Git Rebase třeba i s Gitlab CI, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci), nebudete litovat.


- id: zaznam-devops-live-18-vytvarejte-vlastni-dashboardy-v-grafane
  title: "Záznam DevOps Live #18: Vytvářejte vlastní Dashboardy v Grafane"
  date: 19. 5. 2021
  ad: prometheus
  tags:
    - prometheus
    - devopslive
  perex: |
    Záznanam z osmnáctého live streamu: Vytvářejte vlastní Dashboardy v Grafane
  youtube: KyYqqpFWCpE
  content: |
    Pokud se chcete naučit lépe pracovat s Prometheus, doporučuji Vám mé školení [__Prometheus__](/skoleni/prometheus), nebudete litovat.

- id: zaznam-devops-live-17-ovladnete-makefile-a-zjednodusete-si-manualni-tasky
  title: "Záznam DevOps Live #17: Ovládněte Makefile a zjednodušte si manuální tasky"
  date: 5. 5. 2021
  ad: gitlab-ci
  tags:
    - make
    - devopslive
  perex: |
    Záznam ze sedmnáctého live streamu: Ovládněte Makefile a zjednodušte si manuální tasky
  youtube: hBNFiqUS33k
  content: |
    Pokud se chcete naučit pracovat kromě Makefile třeba i s Gitlab CI, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci), nebudete litovat.

- id: zaznam-devops-live-16-wireguard-jednoducha-a-spolehliva-vpn
  title: "Záznam DevOps Live #16: Wireguard - Jednoduchá a spolehlivá VPN"
  date: 21. 4. 2021
  ad: gitlab-ci
  tags:
    - wireguard
    - devopslive
  perex: |
    Záznanam z šestnáctého live streamu: Wireguard - Jednoduchá a spolehlivá VPN
  youtube: PqezaZGOcH0
  content: |
    Pokud se chcete naučit pracovat kromě Wireguard třeba i s Gitlab CI, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci), nebudete litovat.

- id: zaznam-devops-live-15-jednoducha-distribuce-go-binarek-pomoci-goreleaser-a-ci
  title: "Záznam DevOps Live #15: Jednoduchá distribuce Go binárek pomocí GoReleaser a CI"
  date: 7. 4. 2021
  ad: gitlab-ci
  tags:
    - go
    - goreleaser
    - github
    - ci
    - devopslive
  perex: |
    Záznanam z patnáctého live streamu: Jednoduchá distribuce Go binárek pomocí GoReleaser a CI
  youtube: A99IDxxKmL4
  content: |
    Pokud se chcete naučit pracovat s Gitlab CI, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci), nebudete litovat.

- id: zaznam-devops-live-14-jak-na-lokalni-kubernetes-development-pomoci-skaffold
  title: "Záznam DevOps Live #14: Jak na lokální Kubernetes Development pomocí Skaffold"
  date: 24. 3. 2021
  ad: kubernetes
  tags:
    - kubernetes
    - skaffold
    - devopslive
  perex: |
    Záznanam z čtrnáctého live streamu: Jak na lokální Kubernetes Development pomocí Skaffold
  youtube: 5SDaFLAHHlE
  content: |
    Pokud se chcete naučit pracovat s Kubernetes, doporučuji Vám mé školení [__Kubernetres__](/skoleni/kubernetes), nebudete litovat.

- id: zaznam-devops-live-13-longhorn-jednoducha-on-premise-storage-pro-kubernetes
  title: "Záznam DevOps Live #13: Longhorn - Jednoduchá on-premise storage pro Kubernetes"
  date: 10. 3. 2021
  ad: kubernetes
  tags:
    - kubernetes
    - longhorn
    - devopslive
  perex: |
    Záznanam z třináctého live streamu: Longhorn - Jednoduchá on-premise storage pro Kubernetes
  youtube: pfQG320_l2Q
  content: |
    Pokud se chcete naučit pracovat s Kubernetes, doporučuji Vám mé školení [__Kubernetres__](/skoleni/kubernetes), nebudete litovat.

- id: zaznam-devops-live-12-vlastni-terraform-provider
  title: "Záznam DevOps Live #12: Vlastní Terraform provider"
  date: 24. 2. 2021
  ad: terraform
  tags:
    - terraform
    - devopslive
  perex: |
    Záznanam z dvanáctého DevOps live streamu na téma Vlastní Terraform provider
  youtube: pJOVV_CEpzY
  content: |
    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé školení [__Terraform__](/skoleni/terraform), nebudete litovat.

- id: zaznam-devops-live-11-uvod-do-github-actions
  title: "Záznam DevOps Live #11: Úvod do Github Actions"
  date: 10. 2. 2021
  tags:
    - github
    - gitlab
    - gitlab-ci
    - devopslive
  perex: |
    Záznanam z jedenáctného DevOps live streamu na téma Úvod do Github Actions
  youtube: TYwgCdUdQ20

- id: zaznam-devops-live-10-kubernetes-pomoci-rke
  title: "Záznam DevOps Live #10: Kubernetes pomocí RKE (Rancher Kubernetes Engine)"
  date: 27. 1. 2021
  ad: terraform
  tags:
    - rke
    - terraform
    - kubernetes
    - devopslive
  perex: |
    Záznanam z desátého DevOps live streamu na téma Kubernetes pomocí RKE (Rancher Kubernetes Engine)
  youtube: U9EoKACTUy0
  content: |
    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé školení [__Terraform__](/skoleni/terraform), nebudete litovat.

- id: zaznam-devops-live-9-uvod-do-cloud-initu
  title: "Záznam DevOps Live #9: Úvod do Cloud Initu"
  date: 13. 1. 2021
  ad: terraform
  tags:
    - cloud-init
    - terraform
    - devopslive
  perex: |
    Záznanam z devátého DevOps live streamu na téma Úvod do Cloud Initu
  youtube: hSyBBLWRXLs
  content: |
    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé školení [__Terraform__](/skoleni/terraform), nebudete litovat.

- id: zhodnoceni-roku-2020-a-plany-na-rok-2021
  hidden: false
  title: "Zhodnocení roku 2020 a plány na rok 2021"
  date: 1. 1. 2021
  tags: []
  perex: |
    Další úspěšný a náročný rok je za mnou. Bez Vás bych to však nedokázal. Díky. A co se v roce 2020 dělo?

  content: |
    ## Rok 2020

    Další úspěšný a náročný rok je za mnou. Bez Vás bych to však nedokázal. Díky. A co se v roce 2020 dělo?

    - Nové kurzy
    - DevOps Live
    - Implementace DevOps

    #### Nové kurzy 2020

    Minulý rok jsem ke svým populárním školením Gitlab CI, Dockeru, Kubernetes a Terraformu přidal dalších 5 a rozšířil jsem nabídku kurzů tak, že pokrývají celou DevOps pipeline.

    Moje nové kurzy jsou:

    - [Rancher](/skoleni/rancher) - On-premise Kubernetes
    - [Prometheus Stack (Prometheus, Alertmanager, Grafana)](/skoleni/prometheus) - Nejen cloud native monitoring
    - [Elastic Stack (dříve ELK)](/skoleni/elk) - Log management
    - [DigitalOcean](/skoleni/digitalocean) - Public cloud jednoduše
    - [Proxmox](/skoleni/proxmox) - Open source virtualizace a on-premise cloud platforma

    Pokud máte zájem o nějaké školení nebo jen dotaz, napište mi na <ondrej@sika.io>.

    #### DevOps Live

    V polovině roku 2020 jsem začal dělat streamy live codingu, DevOps Live, a k dnešnímu dni jsme měli 8 eventů na témata Dockeru, monitoringu, Terraformu, a dalších ... Souhrnný blog post DevOps live streamů z 2020 je zde: [DevOps Live 2020](/blog/devops-live-2020/)

    Streamy celkem vidělo už téměř 1000 programátorů, co považuju za velký úspěch a proto v nich chci pokračovat i do budoucna. Koukněte na témata pro [rok 2020](/devopslive).

    #### Implementace DevOps

    Já a můj [team](/team) jsme pro klienty začali v minulém roce dělat DevOps implementace na míru. Jako firma hezky škálujeme. Pokud máte zájem o spolupráci, napište mi email na <ondrej@sika.io>.

    ## Plány pro rok 2021

    A co plánuji do nového roku? Je toho hodně, velkou část projektů jsme rozjeli v roce 2020 a i dříve. Teď nás čeká jejich rozvoj:

    - Nové kurzy
    - Skoleni.io
    - Trainera.io
    - Meetupy & Community
    - Devopsaci.cz

    #### Nové Kurzy 2021

    Plánuji 4 nové kurzy na kterých teď pracuji a které budou brzy k dispozici (Q1).

    - Vault - Secret Management
    - OpenStack (pro vývojáře) - Úvod do správy infrastruktury v OpenStacku
    - AWS (Úvod) - Úvod do cloudové platformy AWS
    - Azure (Úvod) - Úvod do cloudové platformy Azure

    Zaujali mě 2 nové nástroje od HashiCorpu: Boundary a Waypoint. Musím si je vyzkoušet a pokud to bude dávat smysl, vytvořil bych kurzy i na ně.

    Pokud by Vás kurzy zaujali, dejte vědět.

    #### Skoleni.io

    Poslední 3 měsíce v roce 2020 jsme připravovali portál [Školení.io](/skoleniio). Školení.io je portál, kde můžou freelance lektoři nabízet své IT školení a workshopy. Pro firmy je jednodušší hledat školení na jednom místě. Velkou inspiraci mi byl portál Na Volné Noze od Roberta Vlacha.

    Portál Školení.io spouštíme v lednu 2020, na webu už však máme 9 skvělých lektorů a 30+ kurzů. Doufám, že další budou časem přibývat.

    Pokud chcete nabízet svoje kurzy na portálu Školení.io, napište na <spoluprace@skoleni.io>.

    #### Trainera

    Do teď jsem školil jako freelancer. A mělo to své výhody. Vlastně je to má pořád. Velkou výhodou freelance lektora je to, že firmy poptávají přímo jeho. Chtějí konkrétní školení od konkrétního člověka.

    Nevýhodou pak je to, že vše musím vyřizovat sám: od domluvy termínu po fakturace. A toho na mě už bylo moc. Zároveň poptávka po některých kurzech byla vysoká a můj kalendář se hodně plnil. Rozhodl jsem se rozšířit team a školení nabízet i pod brandem Trainera, primárně pro zahraničí.

    ##### Německo

    Své školení chci expandovat za hranice, konkrétně do Německa. To co školím a dělám primárně v Čechách a na Slovensku chci posunout směrem na západ a otevřít první trh a to je Německo.

    Jestli máte někdo zkušenost, budu moc rád, pokud mi dáte rady jak na to.

    #### Meetupy & Community

    V roce 2020 se moc meetupům a osobním setkáním nedařilo, doufám že se to v roce 2021 zlepší. Ale i tak se mi už nechce čekat a chci vykopnout meetupy a komunity, které připravujeme. I když budou meetupy ze začátku online, nemůžu se dočkat, až časem přejdeme do offline, face-to-face.

    - Vercel Czech Community
    - DigitalOcean Czech Community
    - Prague HashiCorp User Group

    ##### Vercel Czech Community

    Vercel meetupy organizuji společně s [Milanem Šulcem](https://sulc.dev) a první online meetup už je za námi. Jeho záznam je na webu [vercel.cz](https://vercel.cz).

    ##### DigitalOcean Czech Community

    DigitalOcean používám rád a rozhodně v Čechách nejsem jediný, chci se potkávat s dalšími lidmi a sdílet zkušenosti s tímto menším cloudem. Věřím, že hodně lidem pomůže zlepšit jejich infrastrukturu, která občas stojí na ne úplně kvalitních poskytovatelích.

    Přidejte se na [digitalocean.cz](https://digitalocean.cz)

    ##### Prague HashiCorp User Group

    Meetupy na témata Terraformu, Vaultu a vlastně všech nástrojů HashiCorpu jsem chtěl začít dělat už minulé jaro, bohužel do toho přišla corona. Ale protože letos je všechno online a lidé si na to zvykli, chci začít hned.

    Více informací na: [hashicorp.cz](https://hashicorp.cz)

    #### Devopsaci.cz

    Je to největší krok k budování DevOps komunity v Čechách. Je tu hodně skvělých meetupů jako je Prague Containers, Cloud Native Prague a další, ale jsou to jen izolované meetupy, ne komunita jako jsou Frontendisti.cz, Backendisti.cz nebo Pehapkari.cz.

    Proto jsem se rozhodl spojit DevOpsáky a založit Devopsaci.cz. Vím, že to nebude jednoduché, budu rád za jakoukoliv radu a pomoc. Díky.

    Cílem komunity je spojit DevOpsaky do jedné skupiny, kde můžou řešit své problémy, postovat zajímavé novinky a vzdělávat se.

    Devopsáci, spojme se na [Devopsaci.cz](https://devopsaci.cz)

    ---

    Pevně věřím, že se v novém roce nepříznivá situace s covidem uklidní a my se budeme moci na školeních nebo na pivu zas potkávat osobně.

    Přeju Vám všem hodně zdraví a energie do roku 2021,
    <br />
    O.

- id: devops-live-2020
  title: "DevOps Live 2020"
  date: 28. 12. 2020
  tags:
    - devopslive
  perex: |
    Souhrn DevOps live streamů za rok 2020
  content: |
    V polovině roku jsem začal dělat krátké livestreamy na témata z DevOps, pravidelně jednou za 14 dní vždy ve Středu v 19:00. Je konec roku a já bych chtěl shrnout, jak se jim dařilo.
    Měli jsme jich celkem 8, z toho vznikly i 2 rozšiřující články na blogu:

    - Správa Gitlabu a Githubu pomocí Terraformu - [záznam](https://www.youtube.com/watch?v=2pbU11RoTRQ), [článek](/blog/sprava-gitlabu-pomoci-terraformu/)
    - Docker & Traefik Proxy - [záznam](https://www.youtube.com/watch?v=C5r8MNys614)
    - Jednoduchá integrace Gitlab CI a Kubernetes - [záznam](https://www.youtube.com/watch?v=uRc1aFcy7CE)
    - Úvod do Terraformu - [záznam](https://www.youtube.com/watch?v=jNx0fnw6qP8)
    - Novinky v Gitlab CI (listopad 2020) - [záznam](https://www.youtube.com/watch?v=vRYvEMiVvTw)
    - Proč a jak používat Cloudflare - [záznam](https://www.youtube.com/watch?v=6C-Pyn3oTV4)
    - Docker monitoring pomocí Prométhea a Alertmanageru - [záznam](https://www.youtube.com/watch?v=m3vogisBUxo)
    - Konfigurace Alertmanageru - [záznam](https://www.youtube.com/watch?v=WBX6bSiZDjo), [článek](/blog/konfigurace-alertmanageru)

    Sledovanost streamů byla skvělá, nečekal jsem zájem 20-30 začínajících programátorů ale i IT expertů na jednu session, což mě mile překvapilo. Je to super a pro mě je to skvělá motivace pokračovat i v dalším roce. Nenechte si ujít další zajímavá témata:

    - Úvod do Cloud Initu
    - Kubernetes pomocí RKE (Rancher Kubernetes Engine)
    - Úvod do Github Actions
    - Vlastní Terraform Provider
    - Longhorn - Jednoduchá on-premise storage pro Kubernetes
    - Skaffold - Local Kubernetes Development
    - GoReleaser a CI

    Přihlásit se na stream můžete zde: [ondrej-sika.cz/devopslive](/devopslive)

    Pokud máte nápad na zajímavé téma, určitě mi dejte vědět na <ondrej@sika.io> a domluvíme se.

- id: konfigurace-alertmanageru
  hidden: true
  title: "Konfigurace Alert Manageru"
  date: 26. 12. 2020
  ad: prometheus
  tags:
    - prometheus
    - alertmanager
    - devopslive
  perex: |
    Alert Manager je komponenta Prometheus monitoring stacku, která se stará o posílání alertů. V článku ukážu jak nastavit Alert Manager tak, aby se správné notifikace odesílali správným teamům, jak seskupovat alerty a jak posílat jen to důležité, když všechno padá.
  content: |
    Alert Manager je komponenta Prometheus monitoring stacku, která se stará o posílání alertů. V článku ukážu jak nastavit Alert Manager tak, aby se správné notifikace odesílali správným teamům, jak seskupovat alerty a jak posílat jen to důležité, když všechno padá.

- id: zaznam-devops-live-8-konfigurace-alertmanageru
  title: "Záznam DevOps Live #8: Konfigurace Alertmanageru"
  date: 22. 12. 2020
  ad: prometheus
  tags:
    - prometheus
    - alertmanager
    - devopslive
  perex: |
    Záznanam ze osmého DevOps live streamu na téma Konfigurace Alertmanageru
  youtube: WBX6bSiZDjo
  content: |
    Pokud se chcete naučit pracovat s Prometheem, doporučuji Vám mé školení [__Prometheus__](/skoleni/prometheus), nebudete litovat.

- id: zaznam-devops-live-7-docker-monitoring-pomoci-promethea-a-alertmanageru
  title: "Záznam DevOps Live #7: Docker monitoring pomocí Promethea a Alertmanageru"
  date: 2. 12. 2020
  ad: prometheus
  tags:
    - prometheus
    - docker
    - alertmanager
    - devopslive
  perex: |
    Záznanam ze sedmého DevOps live streamu na téma Docker monitoring pomocí Promethea a Alertmanageru
  youtube: m3vogisBUxo
  content: |
    Repozitář s ukázkou kódu je: <https://github.com/ondrejsika/example-docker-monitoring>

    Pokud se chcete naučit pracovat s Prometheem, doporučuji Vám mé školení [__Prometheus__](/skoleni/prometheus), nebudete litovat.

- id: zaznam-devops-live-6-proc-a-jak-pouzivat-cloudflare
  title: "Záznam DevOps Live #6: Proč a jak používat Cloudflare"
  date: 18. 11. 2020
  ad: terraform
  tags:
    - cloudflare
    - terraform
    - devopslive
  perex: |
    Záznanam ze šestého DevOps live streamu na téma Proč a jak používat Cloudflare
  youtube: 6C-Pyn3oTV4
  content: |
    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé školení [__Terraform__](/skoleni/terraform), nebudete litovat.

- id: zaznam-devops-live-5-uvod-do-terraformu
  title: "Záznam DevOps Live #5: Novinky v Gitlab CI (listopad 2020)"
  date: 2. 12. 2020
  ad: gitlab-ci
  tags:
    - gitlab
    - gitlab-ci
    - devopslive
  perex: |
    Záznanam z pátého DevOps live streamu na téma Novinky v Gitlab CI
  youtube: Vvx6rS17mrw
  content: |
    Pokud se chcete naučit pracovat s CI v Gitlabu, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci), nebudete litovat.

- id: zaznam-devops-live-4-uvod-do-terraformu
  title: "Záznam DevOps Live #4: Úvod do Terraformu"
  date: 17. 11. 2020
  ad: terraform
  tags:
    - terraform
    - devopslive
  perex: |
    Záznanam z čtvrtého DevOps live streamu na téma Úvod do Terraformu
  youtube: jNx0fnw6qP8
  content: |
    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé školení [__Terraformu__](/skoleni/terraform), nebudete litovat.

- id: zaznam-devops-live-3-integrace-gitlab-ci-a-kubernetes
  title: "Záznam DevOps Live #3: Jednoduchá integrace Gitlab CI a Kubernetes"
  date: 16. 11. 2020
  ad: kubernetes
  tags:
    - kubernetes
    - gitlab-ci
    - devopslive
  perex: |
    Záznanam z třetího DevOps live streamu: Jednoduchá integrace Gitlab CI a Kubernetes
  youtube: uRc1aFcy7CE
  content: |
    Pokud se chcete naučit pracovat s Gitlab CI a Kubernetes, doporučuji Vám mé školení [__Gitlab CI__](/skoleni/gitlab-ci) a [__Kubernetres__](/skoleni/kubernetes), nebudete litovat.

- id: terraform-a-gitlab-ci-14-meetup-cncf-sk
  title: "Terraform a Gitlab CI (14. meetup CNCF.sk)"
  date: 12. 11. 2020
  ad: terraform
  tags:
    - terraform
    - gitlab-ci
    - cncf-sk
  perex: |
    Slides a repozitáře z 14. meetupu Cloud Native - Kubernetes - Bratislava na tema Terraform a Gitlab CI
  content: |
    Slides a repozitáře z 14. meetupu Cloud Native - Kubernetes - Bratislava na tema Terraform a Gitlab CI

    Odkazy:

    - Slides: https://docs.google.com/presentation/d/1K1-bM3SORRLRmr1NBEP_0mWsVnD0GvZzHQCqKoJO4WY/edit
    - Repo: https://github.com/ondrejsika/example-terraform-gitlab-ci
    - Repo (se zmenamy): https://github.com/sika-training-examples/2020-11-12-terraform-gitlab-ci-example

    Odkaz na záznam přidám až bude k dispozici.

    Pokud máte jakékoliv dotazy, napište na <ondrej@sika.io>

- id: zaznam-devops-live-2-docker-a-traefik-proxy
  title: "Záznam DevOps Live #2: Docker & Traefik Proxy"
  date: 25. 9. 2020
  ad: docker
  tags:
    - docker
    - devopslive
  perex: |
    Záznanam z druhého DevOps live streamu: Docker & Traefik Proxy
  youtube: C5r8MNys614
  content: |
    Pokud se chcete naučit pracovat s Dockerem, doporučuji Vám mé [__Školení Dockeru__](/skoleni/docker), nebudete litovat.

- id: zaznam-devops-live-1-sprava-gitlabu-pomoci-terraformu
  title: "Záznam DevOps Live #1: Správa Gitlabu a Githubu pomocí Terraformu"
  date: 11. 9. 2020
  ad: terraform
  tags:
    - terraform
    - gitlab
    - github
    - devopslive
  perex: |
    Záznanam z prvního DevOps live streamu: Správa Gitlabu a Githubu pomocí Terraformu
  youtube: 2pbU11RoTRQ
  content: |
    Pokud Vás zaujal Terraform obecně, budu mít další live stream přímo na základy Terraformu. Registrovat se můžete na [Eventbrite](https://www.eventbrite.com/e/120441195859).

    Pokud se chcete naučit pracovat s Terraformem, doporučuji Vám mé [__Školení Terraformu__](/skoleni/terraform), nebudete litovat.

    <center>
    <Twitter tweet_id="1252334258292752392" />
    </center>

- id: sprava-gitlabu-pomoci-terraformu
  title: "Správa Gitlabu pomocí Terraformu"
  date: 10. 9. 2020
  ad: terraform
  tags:
    - terraform
    - gitlab
    - devopslive
  perex: |
    Jak spravuju Gitlab? Klikám nové uživatele, skupiny, repozitáře? Ne! Používám Terraform a ukážu Vám jak to dělám.
  content: |
    Tento blog post je shrnutím mého prvního live streamu [DevOps Live](/devopslive). DevOps Live je stream live codingu na nějaké DevOps téma, které typicky nepokrývám ve svých školeních. Tento stream byl o možnosti spravovat konfiguraci Gitlabu deklarativním přístupem, čili Terraformem.

    Gitlab představovat nemusím, je to DevOps platforma: hosting Git repozitářů, CI, ... Terraform je nástroj "Infrastructure as a Code", čili na správu infrastrury formou kódu. Terraform se převážně používá na správu Virtuálních strojů, S3 bucketu a Kubernetes clusteru v cloudu, ale dá se použít i na správu Gitlabu (čehokoliv co má API). Jdeme na to.

    ## Setup Terraform konfigurace

    Vytvoříme si repozitář, kam budeme vše dávat. První co vytvoříme bude soubor `terraform.tf`, kde nakonfigurujeme remote backend v Terraform Cloudu, soubor `versions.tf` kde definujeme jaké providery budeme používat a soubor `providers.tf` kde je nainicializujeme.

    ```tf
    // terraform.tf
    terraform {
      backend "remote" {
        organization = "ondrejsika"

        workspaces {
          name = "gitlab"
        }
      }
    }
    ```

    ```tf
    // versions.tf
    terraform {
      required_providers {
        gitlab = {
          source = "terraform-providers/gitlab"
        }
      }
      required_version = ">= 0.13"
    }
    ```

    ```tf
    // providers.tf
    variable "gitlab_token" {}
    variable "gitlab_domain" {}

    provider "gitlab" {
      base_url = "https://${var.gitlab_token}/api/v4/"
      token = var.gitlab_token
    }
    ```

    Terraform nainicializujeme příkazem `terraform init`. Potřebujeme nastavit akorát token, kterému dáme práva na API a sudo a doménu Gitlabu. Používám Terraform remote execution, tyto proměnné mám definované v Terraform Cloudu (samozřejmě Terraformem).

    A teď k samotné správě Gitlabu. Dokumentace ke Gitlab Provideru (`terraform-provider-gitlab`) je na: https://www.terraform.io/docs/providers/gitlab/index.html a je dobře napsaná.

    ## Uživatelé

    Já v Gitlabu potřebuji spravovat hlavně uživatele, skupiny a repozitáře. A samozřejmě vazby mezi nimi.

    Všechny uživatele definuju v jednom souboru `users.tf`.

    ```tf
    // users.tf
    resource "gitlab_user" "vojtechmares" {
      name             = "Ondrej Sika"
      username         = "ondrejsika"
      email            = "xxx@xxx.com"
      can_create_group = false
      reset_password   = false
      projects_limit    = 100000
    }

    resource "gitlab_user" "vojtechmares" {
      name             = "Vojtěch Mareš"
      username         = "vojtechmares"
      email            = "xxx@xxx.com"
      can_create_group = false
      reset_password   = false
      projects_limit    = 100000
    }
    ```

    ## Skupiny

    Ostatní resources se snažím mít odděleně, pro každý mám vlastní soubor, například pro skupinu `www` mám soubor `group_www.tf`. V tomto souboru definuju skupinu, uživatele, kteří jsou v té skupině a další nastavení skupiny, jako například CI environment variables.

    Právě správa CI variables mě přiměla k tomu zamyslet se jak můžu Gitlab spravovat efektivněji, protože spravovat ho ručně je peklo.

    Ukázka konfiguace skupiny je:

    ```tf
    // group_www.tf
    resource "gitlab_group" "www" {
      name        = "www"
      path        = "www"
      visibility_level = "public"
    }

    # --- Members ---

    resource "gitlab_group_membership" "www_vojtechmares" {
      group_id     = gitlab_group.www.id
      user_id      = gitlab_user.vojtechmares.id
      access_level = "owner"
    }

    # --- Variables ---

    resource "gitlab_group_variable" "www_DEV_DOMAIN_SUFFIX" {
      group     = gitlab_group.www.id
      key       = "DEV_DOMAIN_SUFFIX"
      value     = "xsika.cz"
      protected = false
      masked    = false
    }
    ```

    ## Projekty

    A nakonec definice projektu. Velkou výhodou vytváření projektu Terraformem je, že je možné nastavit parametry, které se musí manuálně nastavovat pro každý repozitář manuálně, jako je například Fast-Forward Only merge strategie. Pokud použiju Terrafrom modul, nebo duplikuji konfiguraci předchozího projektu, mám jistotu, že nastavení je rovnou správné. Zde je ukázka `www/www` projektu v souboru `project_www_www.tf`:

    ```tf
    // project_www_www.tf
    resource "gitlab_project" "www_www" {
      namespace_id = gitlab_group.www.id
      name = "www"
      visibility_level = "public"
      merge_method = "ff"
      default_branch = "master"
      remove_source_branch_after_merge = true
    }
    ```

    ## Závěr

    A teď už stačí po každé úpravě zavolat `terraform apply` a máme změny nasazené. Gitlab provider podporuje ještě mnoho další konfigurace, například integrace s Kubernetes, ale o tom příště.

    Já beru možnost konfigurovat Gitlab deklarativní formou jako velké šetření času a možnost mít přehled o aktuálním stavu, navíc verzovaný Gitem.

- id: emaily-jak-a-kam-je-odesilat
  title: "Emaily: Jak a kam je odesílat"
  date: 30. 7. 2020
  tags:
    - email
    - development
  perex: |
    Poslat email z aplikace umí každý. Poslat ho tak, aby to bylo uživatelům příjemné, to už ne. Zde Vám ukážu jak to dělám já a hlavně proč.
  content: |
    Proč píšu tento blog post? Abych ulehčil uživatelům používání emailu, hlavně když mají filtry a automaticky je zpracovávají.

    ## Odesílání emailu z více adres

    Většinou všechny emaily odesíláme z `noreply@app.com` což by nevadilo, když bychom dali uživateli možnost ať si v aplikaci nastaví na jaký email mu mají chodit zásadní akce na jeho účtu (například řešit hesla), kam notifikace (kterých chodí hodně), kam faktury a kam newsletter. To asi neděláte, ještě se k tomu dostanu.

    Podstata je, že máme na klienta 1 email a tam posíláme všechno. Pokud vše posíláme z jednoho emailu, děláme mu potíže s psaním pravidel pro třídění příchozích zpráv.

    Pojďme mu to tedy zjednodušit. Já používám tyto emaily pro odchozí poštu ve většině svých aplikaci a myslím, že to funguje dobře.

    - `noreply-account@app.com` - Důležité změny na účtu, změna hesla, notifikace přihlášení. Vše, co je důležité dostat do inboxu
    - `noreply-notification@app.com` - Pro všechny možné notifikace
    - `noreply-invoice@app.com` - Pro posílání faktur, dá se jednoduše přesměrovat účetní nebo službě, která je platí za Vás
    - `noreply-newsletter@app.com` - Pro newsletter. Pokud si ho chce někdo dát do složky (a koukat do nich jen občas jako to dělám já)

    Proč emaily posílám z různých emailů a ne jen suffixu jako `noreply+account@app.com` a `noreply+newsletter@app.com` je i důvod, že některé emailové služby (jako [HEY.com](https://hey.com)), umožňují dělat jednoduchý screening podle odesílatele a různé from adresy jsou pro ně nejlepší.

    ## Odesílání emailů na různé adresy

    V prvním odstavci jsem psal proč posílám emaily z různých adres. Zároveň některé emaily, typicky ty firemní, nemají možnost nastavování filtru a proto je pro uživatele příjemné, když si může nastavit emaily kam mu budou chodit různé typy zpráv.

    Já nechávám uživateli nastavit si emaily pro stejné kategorie jako mám při odesílání.

    ## Noreply, ale

    Posílání z `noreply@app.com` má zásadní nevýhodu. Když má klient problém, nemůže napsat zpět. Já dělám to, že u každého emailu, který odchází automaticky z `noreply-*@app.com` dávám ještě __Reply-to__ na `support@app.com` a zajistím tak, že zpětnou komunikaci bude někdo řešit.

    ## Závěr

    Pokud navrhujete aplikaci, pro vaše uživatele je konzistentní a přehledné posílání emailů velký bonus. Github to má velmi pěkně udělané, bohužel je to výjimka. I velcí hráči jako Booking nebo PayPal v tom mají velký chaos a pravidla pro ně se píšou velmi těžce (protože jsou převážně závislé na fulltext search).

- id: docker-vs-podman-v-cem-se-lisi
  title: "Docker vs Podman: V čem se liší"
  date: 14. 6. 2020
  ad: docker
  tags:
    - docker
    - podman
  perex: |
    Hlavní rozdíly mezi Dockerem a Podmanem
  content: |
    Docker i Podman jsou nástroje na práci s kontejnery. Podman je novější nástroj, který kopíruje UI Dockeru, ale v tom jak pracují jsou zásadní rozdíly.

    Docker běží jako client/server, Docker client říká serveru jak má vytvářet kontejnery. Namísto toho Podman vytvoří nový proces standardne (fork/exec), Podman také umí běžet pod non-root uživatelem.

    Co se týká bezpečnosti, Podman je lepší. Pokud se někdo dostane k Docker socketu, je de facto root na serveru. Podman nemá žádnou běžící komponetu, každý uživatel vytváří kontejnery ve svém kontextu.

    ### Docker

    - Funguje na modelu client/server
    - Client má pro Linux, Mac i Windows, server běží na Linuxu, v Macu a Windows je Linux VM v xHyve nebo Hyper-V
    - Podpora BuildKit
    - Kontejnery se pustí po restartu serveru

    ### Podman

    - Nemá běžící daemon
    - [Může běžet pod non-root uživatelem](/blog/podman-docker-pod-non-root-uzivatelem)
    - Používá tradiční fork/exec model

    Oba podporují build images, i multistage. Podman však nepodporuje BuildKit. Síťování mají podobně, ale ne stejně.

- id: podman-docker-pod-non-root-uzivatelem
  title: 'Podman: "Docker" pod non-root uživatelem'
  date: 14. 6. 2020
  ad: docker
  tags:
    - docker
    - podman
  perex: |
    Podman je způsob, jak spouštět (Docker) kontejnery pod non-root uživatelem na Linuxu.
  content: |
    Podman je způsob, jak spouštět (Docker) kontejnery pod non-root uživatelem na Linuxu.

    Vytvoříme například uživatele `podman`:

    ```
    useradd podman -m
    ```

    Povolíme `kernel.unprivileged_userns_clone`:

    ```
    sysctl kernel.unprivileged_userns_clone=1
    ```

    Přepneme se do login shellu (důležité) pomocí:

    ```
    su - podman
    ```

    A můžeme spouštět kontejnery:

    ```
    podman run hello-world
    ```

    ```
    podman run -d --name hello -p 8000:80 ondrejsika/go-hello-world:3
    ```

- id: weeknotes-4
  title: "Weeknotes #4"
  date: 7. 6. 2020
  tags:
    - weeknotes
    - kafemlejnek
  perex: |
    Gitlab CI, natáčení podcastu a zkracovač url
  content: |
    Ve středu jsem byl natáčet epizodu podcastu [Kafemlejnek.tv](https://kafemlejnek.tv) o Gitlab CI. Byl to můj první podcast (jako host), tak doufám, že se to povedlo. Uvidíme časem.

    Dále potřebuji pro své marketingové účely url zkracovač, který bude zkracovat url a bude sbirat co nejvíce možných informací o proklikách jako (čas, HTTP referer, IP adresa, ..) a bude se rozumně generovat pomocí API. Nenašel jsem nic použitelného, tak jsem si jeden velmi jednoduchý vytvořil. TODO: zdrojáky dát na Github.

- id: weeknotes-3
  title: "Weeknotes #3"
  date: 31. 5. 2020
  tags:
    - weeknotes
    - surge
    - static-sites
  perex: |
    Zápisky #weeknotes dalšího týdne od 25. do 31.5., školení, landing page a statický hosting surge.sh
  content: |
    V tomto týdnu jsem školil a hodně pracoval na interních věcech. Zde je to nejdůležitější co jsem dělal.

    Pracoval jsem společně s Martinem a Zuzkou na nové Landing Page, na kterou budeme odkazovat nové kontakty. Design je od Matěje Kamenického. A je tam Nelinka (můj pes). Výsledek je zde: [CZ](/hello) a [EN](https://ondrej-sika.com/hello).

    Rozhodl jsem se přesunout statické weby z Kubernetes a hledal jsem ideální platformu, kde je provozovat. Rozhodoval jsem se mezi Vercel (dříve Zeit), Cloudflare Workers, AWS S3 a Surge.sh.

    Nakonec jsem zvolil pro produkční běh Cloudflare Workers a pro testovací deploymenty Surge.sh. Na to téma napíšu obsáhlejší článek, proč jsem si vybral zrovna takto.

- id: weeknotes-2
  title: "Weeknotes #2"
  date: 24. 5. 2020
  tags:
    - weeknotes
    - devopslive
    - terraform
    - poste
  perex: |
    Zápisky #weeknotes dalšího týdne od 11. do 17.5. DevOps Live a další Terraform provider.
  content: |
    Týden uběhl a já zde sepisuji pár věcí co jsem za týden zvládl.

    ### DevOps Live

    Rozhodl jsem se, že budu natáčet livestreamy na témata z DevOps.

    Můj Tweet s dotazníkem, která témata lidí zajímají, se poměrně hodně rozšířil a já mám dostatek informací pro naplánování prvních livestreamů.

    <Twitter tweet_id="1263402541292892160" />

    Takže na DevOps Live se můžete těšit začátkem června. Pokud si pořád chcete vybrat témata a nezmeškat live stream, můžete vyplnit dotazníček <https://forms.gle/gMQJc5qdib5t8B4QA> nebo začít odebírat můj [Newsletter](https://sika.link/newsletter).

    ### Terraform Provider pro Poste.io

    Napsal jsem zatím proof of concept Terraform provideru pro [Poste.io](https://poste.io) mail server. Začínám s Training CRM a chci mít rovnou všechnu infrastrukturu v Terraformu.

    Pokud neznáte Poste.io, je to mail server v jednom Docker kontajneru. Poste.io obsahuje SMTP server, IMAP server, RoundCube, Web Admin, SSL pomocí Let's Encrypt a další komponenty. Je hrozně jednoduchý na instalaci, doporučuji se na něj podívat.

    Má také skvělé API, pro které jsem připravil knihovnu [poste-go](https://github.com/ondrejsika/poste-go), kterou používám v Terraform provideru.

    Vytvořil jsem `terraform-provider-poste` a začal jsem s implementací dvou základních funkcí, které jsem potřeboval. Přidávání domén a vytváření mailboxu. Obojí bylo jednoduché a já tak mužů lehce spravovat moje mailboxy z Terraformu. Viz:

    ```terraform
    provider "poste" {
      origin = "https://poste.sikademo.com/admin/api"
      username = "admin@poste.sikademo.com"
      password = "asdfasdf"
    }

    resource "poste_domain" "foo_com" {
      name = "foo.com"
    }

    resource "poste_box" "foo_foo_com" {
      email = "foo@${poste_domain.foo_com.name}"
      password = "asdfasdf"
    }
    ```

    Zdrojové kódy jsou samozřejmě na Githubu, pomoc nebo návrhy na zlepšení jsou vítané.

    https://github.com/ondrejsika/terraform-provider-poste

- id: weeknotes-1
  title: "Weeknotes #1"
  date: 17. 5. 2020
  tags:
    - weeknotes
    - trainingcrm
    - pipedrive
    - terraform
    - vercel
  perex: |
    Začínám psát týdenní poznámky #weeknotes. Zde je to co jsem dělal v týdnu od 11. do 17.5.
  content: |
    ### Začínám psát Weeknotes

    K psaní týdenních poznámek mě inspiroval Honza Javorek (kterého inspiroval Simon Willison). Poznámky mají sloužit k:

    - zaznamenání toho, co jsem dělal, abych neměl pocit že se flákám
    - zaznamenání toho, co jsem vyřešil a naučil se - může se to hodit i dalším

    Jsem sám na sebe zvědav, jak svědomitý budu.

    ### Vercel

    Po nějakém čase jsem se vrátil k Terraform Provideru pro ZEIT. Mezitím se z ZEITu stal Vercel a tak jsem předělal názvy a api ve všech mých projektech, které s tím Terraform providerem souvisí.

    Taky jsem přidal nějakou další funkcionalitu (práce s DNS záznamy) do mé knihovny `vercel-go`, kterou jsem vytvořil primárně pro ten Terraform provider. A tak jsem ho konečně na tu knihovnu napojil.

    - [ondrejsika/terraform-provider-vercel](https://github.com/ondrejsika/terraform-provider-vercel) - Terraform Provider pro Vercel
    - [ondrejsika/vercel-go](https://github.com/ondrejsika/vercel-go) - Go client pro Vercel API
    - [ondrejsika/vercel-api-mock](https://github.com/ondrejsika/vercel-api-mock) - Vercel API Mock

    ### TrainingCRM

    #### Integrace s Pipedrive

    O víkendu jsem pracoval na TrainingCRM (mém interním CRM na správu školení), převážně na jeho integrací s Pipedrive (to používám pro obchod). TrainingCRM je psané v Djangu a hledal jsem nějaký rozumný Python Client pro Pipedrive až jsem si napsal vlastní. Na Pypi bylo dokonce volné jméno `pipedrive` (což jsem nečekal), takže balíček je zde <https://pypi.org/project/pipedrive/> a zdrojáky na Githubu <https://github.com/ondrejsika/pipedrive>

    #### TrainingCRM jako produkt

    TrainingCRM je moje řešení problémů jak spravovat účastníky na školeních, spolupráci se školícími agenturami, vypisování termínů a další. Zároveň je to i formulářový backend pro mé jinak statické weby v Next.js. Když vidím, jak firmy, se kterými spolupracuji řeší celý proces ručně a mají data po Execelech, rozhodl jsem se věnovat trošku zdrojů a přeměnit mé interní CRM do produktu. Z toho důvodu není TrainingCRM open-source.

- id: ceph-persistent-volumes-v-kubernetes-pomoci-rook
  ad: kubernetes
  title: "Ceph Persistent volumes v Kubernetes pomocí Rook"
  date: 6. 4. 2020
  tags:
    - kubernetes
    - rook
    - ceph
    - storage
  perex: |
    Kubernetes je skvělá platforma na provozování stateless aplikací. Storage je často řešena mimo Kubernetes cluster. Rook.io a Ceph je ultimátní řešení pro perzistentní storage přímo v Kubernetes clusteru.
  content: |
    Kubernetes je skvělá platforma na provozování stateless aplikací. Storage je často řešena mimo Kubernetes cluster. Rook.io a Ceph je ultimátní řešení pro perzistentní storage přímo v Kubernetes clusteru.

    ## Co je CEPH
    Ceph je softwarově definovaná distribuovaná storage, která podporuje block device (RBD), object storage s (AWS S3 interface) a Filesystem (CEPH F5). Skvělý návod do Cephu je tato přednáška, od kamených destiček k distribuované storage za méně než hodinu: https://www.youtube.com/watch?v=7I9uxoEhUdY

    ## Co je to Rook

    Rook je sada Kubernetes operátorů, které výtváří a spravují storage v rámci Kubernetes Clusteru. Nejpoužívanější je Ceph, ale Rook podporuje i mnoho jiných typů storage, například: NFS, Cassandra, ... Přednáška o Rooku a Cephu na YouTube: https://www.youtube.com/watch?v=pNz0UyaqlE8

    ## Setup Infrastruktury

    Abychom mohli provozovat Ceph cluster, potřebujeme minimálně 3 Kubernetes nody s nejméně 4 GB RAM. Každý server musí mít nainstalované LVM (`apt install lvm2`) a nejake disky (eg: `/dev/sdb`), které použije Ceph pro svoji storage. My si to vytvoříme pomocí Terraformu na DigitalOceanu. Rovnou si připravíme i loadbalancer, který bude ukazovat na všechny nody a nasměřujeme na něj nějakou doménu.

    Můžete použít moji ukázku z Githubu [ondrejsika/terraform-do-rook-ceph-example](https://github.com/ondrejsika/terraform-do-rook-ceph-example).

    Ta mi vytvoří 3 servery s druhým diskem (30 GB):

    - rook0.sikademo.com
    - rook1.sikademo.com
    - rook2.sikademo.com

    a laodbalancer, který ukazuje na všechny tyto nody na adrese `rook.sikademo.com` s CNAME `*.rook.sikademo.com`.

    ## Instalace Kubernetes

    Nejdřív potřebujeme nainstalovat Kubernetes. Můžeme použít `kubeadmin` nebo Rancher. Já jsem použil Rancher a postavil jsem cluster kde každý node je master i worker zároveň.

    ```
    rke up
    ```

    Po instalaci clusteru ještě nainstaluju [Traefik Ingress Controller](https://github.com/ondrejsika/kubernetes-ingress-traefik):

    ```
    kubectl apply -f https://k.sika.link/ingress.yml
    ```

    [k.sika.link](https://k.sika.link) je můj tool ([source](https://github.com/ondrejsika/k.sika.link)) na zkrácení cest z `raw.githubusercontent.com` abych nemusel používat celou cestu `https://raw.githubusercontent.com/rook/rook/release-1.3/cluster/examples/kubernetes/ceph/common.yaml` ale jen `https://k.sika.link/rook-ceph-1.3/common.yaml`

    ## Instalace Rooku

    Rook budeme instalovat podle postupu z jejich webu, nejdříve musíme vytvořit custom resources a spustit operátor.

    ```
    kubectl create -f https://k.sika.link/rook-ceph-1.3/common.yaml
    ```

    ```
    kubectl create -f https://k.sika.link/rook-ceph-1.3/operator.yaml
    ```

    Počkáme až naběhnou všechny tyto pody (`kubectl -n rook-ceph get po`):

    ```
    ondrej@sika-mac:~/Examples/rook (master)$ kubectl -n rook-ceph get po
    NAME                                  READY   STATUS    RESTARTS   AGE
    rook-ceph-operator-66d99fccf4-fpwj9   1/1     Running   0          50s
    rook-discover-5q8r4                   1/1     Running   0          28s
    rook-discover-7ng4s                   1/1     Running   0          28s
    rook-discover-dn6bj                   1/1     Running   0          28s
    ```

    ## Setup Ceph clusteru

    Jakmile naběhne operátor a rook discover, můžete nasadit Ceph cluster.

    ```
    kubectl create -f https://k.sika.link/rook-ceph-1.3/cluster.yaml
    ```

    Počkáme dokud cluster nebude ready:

    ```
    ondrej@sika-mac:~/Examples/rook (master)$ kubectl -n rook-ceph get cephcluster
    NAMESPACE   NAME        DATADIRHOSTPATH   MONCOUNT   AGE     PHASE   MESSAGE                        HEALTH
    rook-ceph   rook-ceph   /var/lib/rook     3          4m26s   Ready   Cluster created successfully   HEALTH_OK
    ```

    ## Instalace Storage Class

    Abychom mohli vytvářet vlastní PVC na Cephu, musíme pro to vytvořit Storage Class

    Tu vytvoříme příkazem:

    ```
    kubectl apply -f https://k.sika.link/rook-ceph-1.3/csi/rbd/storageclass.yaml
    ```

    Pokud vypíšeme Storage Classes, tak ji uvidíme:

    ```
    ondrej@sika-mac:~/Examples/rook (master)$ kubectl get sc
    NAME              PROVISIONER                  RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
    rook-ceph-block   rook-ceph.rbd.csi.ceph.com   Delete          Immediate           true                   46s
    ```

    Pokud máme jen jednu storage class, můžeme ji nastavit jako defaultní příkazem:

    ```
    kubectl patch storageclass rook-ceph-block -p '{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}'
    ```

    ## Použítí Storage Class

    Jako ukazku použítí nainstalujeme přes Helm 3 Wordpress:

    ```
    helm repo add ondrejsika https://helm.oxs.cz
    ```

    ```
    ondrej@sika-mac:~/Examples/rook (master)$ helm upgrade --install hello ondrejsika/wordpress-mysql --set host=hello.rook.sikademo.com
    Release "hello" has been upgraded. Happy Helming!
    NAME: hello
    LAST DEPLOYED: Mon Apr  6 19:15:41 2020
    NAMESPACE: default
    STATUS: deployed
    REVISION: 4
    TEST SUITE: None
    NOTES:
    See: https://hello.rook.sikademo.com
    ```

    Můžeme kouknout, že se storage připojili a pody běží:

    ```
    ondrej@sika-mac:~/Examples/rook (master)$ kubectl get po,pvc,pv
    NAME                                   READY   STATUS    RESTARTS   AGE
    pod/hello-mysql-0                      1/1     Running   0          14m
    pod/hello-wordpress-7fdb4565f8-d7dns   1/1     Running   0          12m

    NAME                                    STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE
    persistentvolumeclaim/hello-mysql       Bound    pvc-157cba57-822f-43a0-ac97-54ef699a1c47   1Gi        RWO            rook-ceph-block   14m
    persistentvolumeclaim/hello-wordpress   Bound    pvc-fd576f28-f9bd-475d-bceb-89e7eefca856   1Gi        RWO            rook-ceph-block   14m

    NAME                                                        CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                     STORAGECLASS      REASON   AGE
    persistentvolume/pvc-157cba57-822f-43a0-ac97-54ef699a1c47   1Gi        RWO            Delete           Bound    default/hello-mysql       rook-ceph-block            14m
    persistentvolume/pvc-fd576f28-f9bd-475d-bceb-89e7eefca856   1Gi        RWO            Delete           Bound    default/hello-wordpress   rook-ceph-block            14m
    ```

    Vidime, že všechno jede. To je vše. Můžeme se na náš Wordpress podívat na https://hello.rook.sikademo.com

- id: wireguard
  title: "Wireguard: Náhrada IPSecu a OpenVPN v jednom"
  date: 4. 4. 2020
  tags:
    - wireguard
    - vpn
  perex: |
    Wireguard je extrémně jednoduchá a rychlá VPN. Vlastně náhrada IPSecu a OpanVPN v jednom. Běží všude, v kernelu je jako network modul a má klienta pro Mac, iOS, Android, Windows ...
  content: |
    Na Wireguard už mě před nějakým časem navedl Michael Kaplan a chci mu za to veřejně poděkovat. I přes počáteční problémy (asi jako se vším) jsem Wireguard rozjel a je naprosto super.

    ## Co je Wireguard

    Wireguard je extrémně jednoduchá a rychlá VPN. Vlastně náhrada IPSecu a OpanVPN v jednom. Běží všude, v kernelu je jako network modul a má klienta pro Mac, iOS, Android, Windows ...

    Používá moderní kryptografii (jako SSH) a nepoužívá žádné x509 certifikáty, prostě jen veřejný a privátní klíč. Konfigurace sítí, jak na straně serveru, tak na straně klienta je velmi jednoduchá. Můžete velmi jednoduše nakonfigurovat jaké rozsahy mají být přístupné z VPN na straně serveru a jaký traffic má jít přes VPN na straně klienta. A to vše v jednom souboru `/etc/wireguard/wg0.conf`. Spouští se pomocí jednoho příkazu `wg-quick up wg0`. Velmi jednoduché.

    Podporuje také roaming, můžete měnit IP adresu a stále komunikovat se zbytkem sítě. Hezky to napsal Petr Krčmář v článku na Rootu: https://www.root.cz/clanky/wireguard-moderni-a-snadno-pouzitelna-vpn-v-linuxovem-jadre/

    Super talk přímo od autora Wireguardu na Youtube: https://www.youtube.com/watch?v=eYztYCbV_8U

    ## Setup Wireguardu

    Pojďme si ukázat jak Wireguard nakonfigurovat. Máme VPN server na IP adrese `vpn.sikademo.com`, firemní síť `192.168.100.0/24` kde máme server s klientem k VPN na adrese `192.168.100.101`. Dále máme notebook a telefon, které chceme také do VPN připojit.

    Budu používat VPN server na Debian 10, kde je wireguard v repozitářích. Na firemní síti také poběží Debian 10, na notebooku mám Mac a telefon IPhone.

    ### Instalace

    Na serverech nainstaluju balíčky `wireguard` a `resolvconf`.

    ```
    apt update && apt install -y wireguard resolvconf
    ```

    Na Macu nainstaluju Wireguard z [Mac App Store](https://apps.apple.com/us/app/wireguard/id1451685025), stejně tak na iPhone z [App Store](https://apps.apple.com/us/app/wireguard/id1441195209).

    Pokud chci i wireguard tools, musím je nainstalovat pomocí brew

    ```
    brew install wireguard-tools
    ```

    ## Setup Serveru

    Na serveru (`vpn.sikademo.com`) si vytvořím konfigurační soubor `/etc/wireguard/wg0.conf` s tímto obsahem:

    ```
    [Interface]
    Address = 10.10.0.1/24
    ListenPort = 51820
    PrivateKey = Vpn/Priv=

    PostUp = iptables -t mangle -A POSTROUTING -p tcp --tcp-flags SYN,RST SYN -o eth0 -j TCPMSS --clamp-mss-to-pmtu
    PostUp = ip6tables -t mangle -A POSTROUTING -p tcp --tcp-flags SYN,RST SYN -o eth0 -j TCPMSS --clamp-mss-to-pmtu
    PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
    PostUp = ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
    PostUp = iptables -A FORWARD -i %i -j ACCEPT
    PostUp = ip6tables -A FORWARD -i %i -j ACCEPT
    PostUp = sysctl -q -w net.ipv4.ip_forward=1
    PostUp = sysctl -q -w net.ipv6.conf.all.forwarding=1

    PostDown = sysctl -q -w net.ipv4.ip_forward=0
    PostDown = sysctl -q -w net.ipv6.conf.all.forwarding=0
    PostDown = iptables -D FORWARD -i %i -j ACCEPT
    PostDown = ip6tables -D FORWARD -i %i -j ACCEPT
    PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
    PostDown = ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
    PostDown = iptables -t mangle -D POSTROUTING -p tcp --tcp-flags SYN,RST SYN -o eth0 -j TCPMSS --clamp-mss-to-pmtu
    PostDown = ip6tables -t mangle -D POSTROUTING -p tcp --tcp-flags SYN,RST SYN -o eth0 -j TCPMSS --clamp-mss-to-pmtu

    [Peer]
    PublicKey = Office/Pub=
    PresharedKey = Office/Preshared=
    AllowedIPs = 10.10.0.101/32, 192.168.100.0/24

    [Peer]
    PublicKey = Mac/Pub=
    PresharedKey = Mac/Preshared=
    AllowedIPs = 10.10.0.201/32

    [Peer]
    PublicKey = Phone/Pub=
    PresharedKey = Phone/Preshared=
    AllowedIPs = 10.10.0.202/32
    ```

    Interface popisuje jak vypadá interface wg0, co je standardní interface. Adresa `10.10.0.1/24` je adresa na VPN síti a port `51820` je standardní UDP port kde Wireguard poslouchá. Dále je tam privátní klíč (v mé ukázce nevalidní placeholder `Server/Private=`), který vygenerujete příkazem `wg genkey`. V skeci post up / post down je nastavení forwardu a masquarade.

    Pak jsou na definice jednotlivých klientů, peeru. Budeme mít 3 klienty: server v kanceláři, počítač a telefon. Klienti jsou definováni pouze jejich veřejným klíčem, žádné certifikáty nejsou potřeba.

    První klient (office) mám v allowed IPs také rozsah sítě v kanceláři abychom se na ni z VPN dostali.

    Konfigrurce klientů jsou jednodušší, takhle vypadá konfigurační soubor na klientovi v kanceláři:

    ```
    [Interface]
    PrivateKey = Priv/Office=
    Address = 10.10.0.100/32
    DNS = 1.1.1.1

    PostUp = sysctl -w net.ipv4.ip_forward=1
    PostUp = iptables -A FORWARD -i wg0 -j ACCEPT
    PostUp = iptables -A FORWARD -o wg0 -j ACCEPT
    PostUp = iptables -t nat -A POSTROUTING -o wg0 -j MASQUERADE
    PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

    PostDown = sysctl -w net.ipv4.ip_forward=0
    PostDown = iptables -D FORWARD -i wg0 -j ACCEPT
    PostDown = iptables -D FORWARD -o wg0 -j ACCEPT
    PostDown = iptables -t nat -D POSTROUTING -o wg0 -j MASQUERADE
    PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

    [Peer]
    PublicKey = Vpn/Pub=
    PresharedKey = Office/Preshared=
    AllowedIPs = 10.10.0.0/24
    Endpoint = vpn.sikademo.com:51820
    PersistentKeepalive = 25
    ```

    Klinet má zase privátní klíč (který má server v peeru) a v peeru má veřejný klíč VPN serveru. Dále má adresu `10.10.0.100/32` na VPN a DNS nastavené na Cloudflare (něco jako `8.8.8.8` od Google).

    V Peeru má potom pouze VPN server kam se připojuje.

    Co se týká konfigurace na Macu a iPhone, je to ještě jednodušší.

    ```
    [Interface]
    PrivateKey = Mac/Priv=
    Address = 10.10.0.201/24
    DNS = 1.1.1.1

    [Peer]
    PublicKey = Vpn/Pub=
    PresharedKey = Mac/Preshared=
    AllowedIPs = 10.10.0.0/24, 192.168.100.0/24
    Endpoint = vpn.sikademo.com:51820
    PersistentKeepalive = 25
    ```

    Na Macu ani na iPhone už není potřeba PostUp/PostDown, takže konfigurace je ještě přímočařejší. Když se podíváme do AllowedIPs, je tam kromě sítě VPN také adresa sitě v kanceláři, což nám říká, že packety směřující do kanceláře mají jít skrz VPN.

    Pokud chceme aby všechen traffic byl skrz VPN, nastavíme `AllowedIPs = 0.0.0.0/0, ::/0`.

    Konfigrurce na telefonu vypadá velice podobně

    ```
    [Interface]
    PrivateKey = Phone/Priv=
    Address = 10.10.0.202/24
    DNS = 1.1.1.1

    [Peer]
    PublicKey = Vpn/Pub=
    PresharedKey = Phone/Preshared=
    AllowedIPs = 10.10.0.0/24, 192.168.100.0/24
    Endpoint = vpn.sikademo.com:51820
    PersistentKeepalive = 25
    ```

    ## Start

    Když chceme na Linuxu Wireguard zapnout, stačí nám k tomu `wg-quick up wg0`. `wg0`, co je název interface a zároveň jméno souboru v `/etc/wireguard/`. Pokud jej chceme vypnout, použijeme `wg-quick down wg0`. V případě potřeby spouštění při startu systému je ideální použít `systemctl enable wg-quick@wg0`, tímto zapneme službu. Tímto příkazem `systemctl start wg-quick@wg0` službu spustíme, a tímto příkazem zase zjistíme status služby `systemctl status wg-quick@wg0` Pokud soubor změníme, musíme vždy Wiregurd vypnout a pak zapnout.

    Na Macu a v telefonu to znamená jen připojit se do profilu VPN.

    A je to. Wireguard je hodně robustní, takže i když se spojení rozváže, dokáže si ho velmi rychle navázat zpět bez nutnosti interakce.

    ## Shrnutí

    S Wireguardem mám velmi pozitivní zkušenost, už jej používám na všech svých projektech produkčně a žádná chyba. Rozhodně je to něco co stojí za vyzkoušení a myslím si, že si jej zamilujete (i ti, kdo nesnáší VPN a sítě jako já).

    ## Zdroje

    - https://www.wireguard.com/
    - https://www.linode.com/docs/networking/vpn/set-up-wireguard-vpn-on-ubuntu
    - https://staaldraad.github.io/2017/04/17/nat-to-nat-with-wireguard/
    - https://www.ericlight.com/wireguard-part-two-vpn-routing.html
    - https://www.youtube.com/watch?v=eYztYCbV_8U
    - https://github.com/burghardt/easy-wg-quick

- id: coronavirus-outbreak
  nostatic: true
  title: Coronavirus 😷🦠
  date: 17. 3. 2020
  tags: []
  perex: |
    Coronavirus mé školení nezastaví, školím dál, ale on-line. Přes Zoom, Google Hangouts, Whereby nebo GoToWebinar.
  content:
- id: australia-on-fire
  nostatic: true
  title: Pomozte Austrálii 🐨🦘❤️
  date: 6. 1. 2020
  tags: []
  perex: |
    Přispěte na pomoc Austrálii, dostanete slevu na školení nebo konzultaci ve výši daru.
  content:
- id: novinky2020
  title: Novinky v roce 2020
  date: 1. 1. 2020
  tags: []
  perex: |
    Tento článek je vlastně shrnutí toho co jsem do teď dělal a také jaké věci plánuji. Je toho opravdu hodně. Článek jsem poslal také jako můj první newsletter v roce 2020.
  content: |
    Tento článek je vlastně shrnutí toho co jsem do teď dělal a také jaké věci plánuji. Je toho opravdu hodně. Článek jsem poslal také jako můj první newsletter v roce 2020.

    - [Kompletní DevOps Pipeline](#kompletn--devops-pipeline)
    - [Nové kurzy do roku 2020](#nové-kurzy-do-roku-2020)
      - [Terraform](#terraform)
      - [Prometheus](#prometheus)
      - [ELK / EFK](#elk---efk)
      - [Proxmox](#proxmox)
      - [React & Next.js](#react---next-js)
    - [Články z roku 2019](#-l-nky-z-roku-2019)
    - [Videokurzy](#videokurzy)
    - [Trainera](#trainera)
    - [Meetupy](#meetupy)

    ## Kompletní DevOps Pipeline

    Od teď nabízím školení a konzultace celé DevOps pipeline na open source stacku.

    Školím tyto technologie, které na sebe krásné navazují a tvoří ucelený DevOps proces:

    Verzovani v Gitu, správa repozitářů v Gitlabu. Nasazování aplikací v Dockeru do Kubernetes, automaticky pomocí Gitlab CI. Správa infrastruktury pomocí Terraformu a konfigurace pomocí Ansible. Správa logu v ELK / EFK a monitoring pomocí Promethea.

    ## Nové kurzy do roku 2020

    Do roku 2020 jsem si připravil nové kurzy na termata __Terraform__, __Prometheus__ a __ELK / EFK__. Dále dělám kurzy __Proxmoxu__ s Michaelem Kaplanem a __React & Next.js__ se Zuzkou Jeschke.

    #### Terraform

    Terraform Vám usnadňuje spravovat infrastrukturu jako kód. To znamená v Gitu a se vším co k tomu patří. Merge / Pull Requesty, code review, forky a další. Správa vaší infrastruktury (public a private cloud) se stane jednodušší a mnohem přehlednější.

    Zajímá Vás Terraform? Více na stránce [Školení Terraform](/skoleni/terraform)

    #### Prometheus

    Na Kubernetes navazují další témata: monitoring a správa logu. Monitoring a metriky nám obstarává Prometheus. Je to graduated project (stejně jako Kubernetes) pod CNCF.io a je velmi pěkně integrovatelný s moderními aplikacemi jako je Kubernets, Traefik, CAdvisor (monitoring Dockeru). Je to robustní systém na sbírání metrik a monitoring.

    Více na stránce [Školení Prometheus](/skoleni/prometheus)

    #### ELK / EFK

    Jako druhý nástroj navazující na Kubernetes je ELK nebo Elastic Stack. Je to sada nástrojů na správu logu: Elastisticsearch (storage), Logstash / Fluentd (log parsing), Kibana (dashboard). Do ELK stacku můžete agregovat logy nejen z Kubernetes, ale veškeré vaše logy. Budete mít full text index nad logy a mnohem jednodušší práci s nimi.

    Více na stránce [Školení ELK / EFK](/skoleni/elk). Kurz bude k dispozici začátkem února.

    #### Proxmox

    Proxmox je virtulizační platforma používající KVM (Kernel Virtual Machines). Je to velmi dobrá open source alternativa k VMware, která poskytuje, live migrace VMs, zálohování, snapshoty a mnoho dalšího. Má také integrovanou podporu distribuované storage CEPH.

    Školení dělám já a Michael Kaplan. Více na stránce [Proxmox](/skoleni/proxmox)

    #### React & Next.js

    Kromě DevOps hodně pracují s Reactem a Next.js. Proto jsme se [Zuz](https://zuzjes.com) rozhodli připravit také školení Reactu. Na školení intenzívně pracujeme.

    Více informací bude na stránce [Školení React & Next.js](/skoleni/react). Školení dělám já a [Zuzana Jeschke](https://zuzjes.com). Kurz bude k dispozici začátkem února.

    ## Články z roku 2019

    Začal jsem také psát články, ty nejzajímavější jsou zde:

    - [Novinky v Helm 3](/blog/helm3) (blog post)
    - [Správa Cloudflare DNS pomocí Terraformu](/terraform/sprava-cloudflare-dns-pomoci-terraformu)
    - [Git Rebase](/git/rebase)
    - [Git Hooks](/git/hooks)
    - [Docker s TLS](/docker/docker-s-tls)
    - [Proč by každý měl mít svoji doménu](/clanky/proc-by-kazdy-mel-mit-svoji-domenu/)
    - [Proč mít email na vlastní doméně](/clanky/proc-mit-email-na-vlastni-domene)


    ## Videokurzy

    Připravuji video verze mých nejpopulárnějších školení: Docker, Kubernetes, Terraform a Gitlab CI. Budou k dispozici koncem Ledna. Více informací je na stránce [Videokurzy](/videokurzy).

    Každy videokurz obsahuje úvod do dané technologie a step-by-step lekce jak řešit konkrétní problémy a jak s nástrojem efektivně pracovat. Videokurzy mám za zaváděcí cenu 1000 CZK za kurz za osobu, při koupi všech čtyř najednou je cena 3200 CZK.

    Pokud jej chcete koupit do firmy cena videokurzu je 10 000 CZK pro všechny zaměstnance.

    Opakování je matka moudrosti, pokud jste u mě měli školení na dané téma, kurz máte se slevou 50% čili za 5000 CZK pro firmu.

    ## Trainera

    Založil jsem firmu Trainera s.r.o., pod kterou začínáme dělat školení pro větší společnosti a ve větším teamu. Pořád zůstávám jako freelancer a pořád Vám jsem schopný konzultovat a školit DevOps sám, ale mám po svých kurzech větší poptávku než stíhám obsloužit a proto jsem založil firmu abych nemusel výrazně zdražit a zaměřit se jen na banky a velké korporace. Rozšiřují team a snažím se ve více lidech školit ve stejné úrovni v jaké jsem školil do teď. Držte mi palce.

    Můžete se podívat na nabídku kurzů od [Trainera.io](http://trainera.io), ale je to zatím de facto to co nabízím já. Pokud chcete spolupracovat výhradně se mnou, nic se pro Vás nemění.

    ## Meetupy

    Jako další výzvu jsem bral pomoc komunitě a chtěl jsem část svých znalosti předat dál. Proto jsem založil meetup group v Salzburgu. Proč Salzburg? Rád jezdím do hor a neměli tam DevOps meetupy, tak je Salzburg spojení příjemného s užitečným.

    ### Salzburg DevOps Meetups

    Na Meetups máme 30 lidí a v únoru plánujeme první meetup o Dockeru a Kubernetes.

    Více na [meetup.com/Salzburg-DevOps-Meetups](https://www.meetup.com/Salzburg-DevOps-Meetups/)

    ## Závěrem bych rád poděkoval

    Vám za dosavadní spolupráci a Váš zájem. Budu se snažit zlepšovat DevOps a procesy v IT firmách nejen v České Republice. Díky, že jste se mnou.

    Sám bych všechno co jsem zde sepsal určitě nezvládl. A ani bych se nedostal do stavu v kterém jsem teď. Chtěl bych tímto poděkovat mému teamu za obrovské úsilí, které vynaložili.

    Jmenovitě Martinovi Jurčovi ([jurco.io](https://jurco.io)), který mi manažuje operations včetně klientů a marketingu. Martin mi skvěle nastavil firemní procesy, udělal migraci z naprostého punku do CRM (která mě bolela, ale musím si přiznat že přinesla své ovoce) a řídí vše co nemusím dělat já. Já se díky tomu mohu naplno věnovat technickým věcem a školením. Pokud budete potřebovat poradit s podobnými věcmi, zkuste požádat Martina.

    Dále bych rád poděkoval Zuzce ([zuzjes.com](https://zuzjes.com)), přítelkyni, která mě ne jen podporovala, ale udělala hromadu práce na webech v Reactu.

    Díky také patří Kátě, která mi pomáhala s obecnou agendou a řešila za mě úkoly, na které jsem neměl čas ani chuť.

    Ať se Vám daří v roce 2020

    ![PF 2020](/content/pf2020_800px.jpg)

- id: errli
  title: err.li - Url zkracovač na odkazy z chyb na Github
  date: 31. 12. 2019
  tags:
    - git
    - github
  perex: |
    Projekt inspirovaný err.sh od ZEITu na jednoduché vkládání odkazu na chyby z repozitáře do chybových výstupu.
  content: |
    Správné vysvětlení chyb je základ. Bohužel ne vždy se celý popis vejde do chybového výstupu. Naštěstí můžeme vložit odkaz na popis chyby. Kde ty popisy mít uložené? Ideálně v Gitu. Ale odkazy na Githubu jsou dlouhé, zkracovat jeden po druhém není moc reálné.

    Co s tím? S nápadem přišli lidí z [ZEIT.co](https://zeit.co) a napsali [err.sh](https://err.sh), který dělá to, že odkáže na konkrétní popis chyby v daném repozitáři. Například <https://err.sh/micro/path-missing> směřuje na <https://github.com/zeit/micro/blob/master/errors/path-missing.md>.

    Něco takového jsem udělal i já na svém [err.li](https://err.li).

    Mě to odkazuje takto:

    - `err.li/[user]/[repo]/[error]` -> `github.com/[user]/[repo]/blob/master/errors/[error].md`
    - `err.li/[repo]/[error]` -> `err.li/ondrejsika/[repo]/[error]`
    - `err.li/[error]` -> `err.li/ondrejsika/errors/[error]`

    Funguje to úplně stejně, jen implementace je trošku jiná. Err.sh používá Node.js microservice ([source](https://github.com/zeit/err-sh)), já pouze funkcionalitu ZEIT.co ([now.json](https://github.com/ondrejsika/err.li/blob/master/now.json)).

    Ukázka mého projektu zde: https://err.li/tf.sh/state-is-locked

    #### Odkazy

    - err.li home page - https://err.li
    - err.sh blog post - https://zeit.co/blog/err-sh
    - err.li source code - https://github.com/ondrejsika/err.li
    - err.sh source code - https://github.com/zeit/err-sh
- id: helm3
  title: Helm 3, Tillerless Helm
  date: 14. 11. 2019
  ad: kubernetes
  tags:
    - kubernetes
    - helm
  perex: |
    Helm3! Konečně! Tillerless Helm verze 3 je tady a tohle je jeho krátká recenze na základě jeho používání.
  content: |
    __Helm__ asi znáte, je to balíčkovací nastro pro __Kubernetes__. Ted ale přišel zásadní release v podobě verze 3 a já Vám ukážu novinky a rozdíly oproti předchozí verzi, které mě zaujali.

    ### Tillerless Helm
    Největší a asi i nejočekávanější novinkou je to že Helm 3 už je čistě client, nepotřebuje se instalovat do clusteru (Tiller). Pro mě je to skvělá zpráva a možnost začít používat Helm na plno.

    Dříve jsem Helm používal primárně jako Template engine, protože jsem nasazoval tímto stylem:

    ```bash
    helm template ./helm/myapp --name myapp.cz --set host=myapp.cz | kubectl apply -f -
    ```

    Výhodou byla absence nutnosti Tilleru (části Helmu běžící v clusteru) a nevýhodou bylo to že se to nechovalo jako jeden balíček a pořád jsem to musel spravovat ručně (pomocí `kubectl`). Další nevýhodou bylo to že helm neuměl vyrenderovat template z balíčku v repozitari, také jsem musel mít zdrojaky součástí repozitare, který z Gitlab CI nasazoval, anebo nějak stažené.

    To se teď mění. Mužů používat Helm i jako správě nasazených aplikaci.

    ### Nasazování přímo z Helmu

    Když nasazují přímo z Helmu, mám několik možnosti a vasechny jsou pěkně:

    #### Podle Chartu

    ```
    helm repo add ondrejsika https://helm.oxs.cz
    helm install hello ondrejsika/one-image --set hello.k8s.sikademo.com
    ```

    #### Ze zdroje Chartu

    ```
    helm install hello2 ./helm/one-image --set hello2.k8s.sikademo.com
    ```

    #### Z archivu Chartu

    ```
    helm install hello3 ./one-image.tgz --set hello3.k8s.sikademo.com
    ```

    #### Z archivu Chartu na webu

    ```
    helm install hello4 https://helm.oxs.cz/one-image-1.1.1.tgz --set hello4.k8s.sikademo.com
    ```

    #### Z Chartu ve specifickém repozitari

    ```
    helm install hello5 --repo https://helm.oxs.cz one-image --set hello5.k8s.sikademo.com
    ```

    ### Helm Upgrade

    Příkaz `helm upgrade` se chová stejně jako ve verzi 2, ale díky nové struktuře `helm install` to celé dává větší smysl. Zároveň pořád funguje parametr `--install` tazke můžete pořád používat klasický install upgrade, což je obdoba `helm template ... | kubectl apply ...`.

    ```
    helm upgrade --install nginx ondrejsika/one-image --set image=nginx --set host=nginx.k8s.sikademo.com
    ```

    a samotný upgrade:

    ```
    helm upgrade nginx ondrejsika/one-image --set image=nginx:alpine --set host=nginx.k8s.sikademo.com
    ```

    ### Helm Uninstall místo Helm Delete

    Helm 3 má příkaz `helm uninstall`, který nahrazuje `helm delete redis --purge`. Po odinstalování můžete rovnou nasadit nový chart pod stejným jménem.

    Pokud chcete zachovat historii (dříve bez parametrů `--purge`), teď musíte přidat parametr `--keep-history`

    ### Helm Status

    Příkaz `helm status` neukazuje resources jak jsme byli zvyklí z Helm 2, je to spíš feature než bug, ale podle diskuze na [Githubu](https://github.com/helm/helm/issues/5952) se tam možná tato funkcionalita vrátí.

    Dá se to vyřešit pomocí těchto způsobu:

    ```
    helm get manifest hello | kubectl get -f -
    ```

    Nebo na to Marc Khouzam napsal plugin do Helmu, který vypíše jak status tak ten `kubectl get ...`. Stačí nainstalovat:

    ```
    helm plugin install https://github.com/marckhouzam/helm-fullstatus
    ```

    A pustit:

    ```
    helm fullstatus hello
    ```

    ### Ostatní změny v CLI

    - `helm init` je odstraněn, není potřeba ;)
    - `helm inspect` -> `helm show`
    - `helm fetch` -> `helm pull`

    ### Závěr

    Helm 3 je jednoznačně super, splnil všechny mě očekávání. Myslím, že řada lidí nechtěla používat Helm kvůli Tilleru, teď už to není důvod. Helm 3 používám už nějakou dobu jako beta & RC a jsem s ním naplno spokojený.

    ### Zdroje

    - https://helm.sh/blog/helm-v3-beta/
    - https://github.com/helm/helm/issues/5952

- id: javadays2019
  title: Docker & Kubernetes Talk @ JavaDays 2019
  ad: docker
  date: 12. 11. 2019
  perex: |
    Slides a ukazka kodu z me prednasky o Dockeru a Kubernetes.
  content: |

    Slides z prednasky na Speaker Deck: <https://speakerdeck.com/ondrejsika/introduction-to-docker-and-kubernetes-at-javadays-2019>

    Ukazkovy projekt: [ondrejsika/javadays2019](https://github.com/ondrejsika/javadays2019)

    Pokud se Vam prednaska libila budu rad kdyz o ni tweetnetes s `@ondrejsika` a `#javadayscz`. Diky.

    Zajima Vas Docker nebo Kubernetes? Muzete si objednat moje [Skoleni Dockeru](/skoleni/docker) a [Skoleni Kubernetes](/skoleni/kubernetes) nebo prijit na nejaky [otevreny termin](/verejne-terminy)

- id: terraform-prednaska-linuxdays-2019
  url: /blog/2019/terraform-prednaska-linuxdays-2019
  title: Terraform prednaska na LinuxDays 2019
  ad: terraform
  date: 6. 10. 2019
  perex: |
    Slides, video a ukazka kodu z me prednasky o Terraformu.
  content: |

    Slides z prednasky na Speaker Deck: <https://speakerdeck.com/ondrejsika/terraform-infrastructure-as-a-code>

    Ukazkovy projekt: [ondrejsika/linuxdays2019-terraform](https://github.com/ondrejsika/linuxdays2019-terraform)

    Video zaznam na YouTube: <https://www.youtube.com/watch?list=PLlTxFw5y5UZtIUJgYb-aEcjV21x8TGgLx&v=-u4OOoJd6ck>

    Zajima Vas Terraform? Muzete prijit na moje [Skoleni Terraformu](/skoleni/terraform)

- id: react-next-workshop-linuxdays-2019
  url: /blog/2019/react-next-workshop-linuxdays-2019
  title: React & Next.js Workshop na LinuxDays 2019
  date: 5. 10. 2019
  ad: react
  perex: |
    Dnes jsem mel workshop na LinuxDays, zde jesou materialy a ukazkovy projekt.
  content: |
    "Slides" pro workshop: [ondrejsika/linuxdays2019-react](https://github.com/ondrejsika/linuxdays2019-react)

    Ukazkovy projekt: [ondrejsika/linuxdays2019-react--example](https://github.com/ondrejsika/linuxdays2019-react--example)

    Nestihli jste workshop na LinuxDays? Nevadi, muzete prijit na moje [Skoleni Reactu](/skoleni/react)

- id: terminy-skoleni-podzim-2019
  url: /blog/2019/terminy-skoleni-podzim-2019
  title: Terminy skoleni na podzim 2019
  date: 4. 10. 2019
  perex: |
    Mate zajem o nejake me skoleni? Zde jsou terminy do konce roku 2019.
  content: |
    Tento rok uz mam skoro cely vybookovany a tak nabizim terminy, kdy mam vypsane verejne terminy, kam se muzete prihlasit pripadne, kam muzete poslat Vase vyvojare. Vypsane mam terminy Dockeru, Kubernetes a Gitlab CI, muzete se podivat na stranku [Verejne Terminy](/verejne-terminy). Pokud mate zajem o jiny kurz, napiste mi mail a domluvime se.

- id: mac-os-vs-debian-i3
  url: /blog/2019/mac-os-vs-debian-i3
  title: Mac OS vs Debian + i3
  date: 5. 2. 2019
  perex: |
    Chci si koupit Mac. Uz po čtvrté jej testuji. Mam iPhone, iPad, Apple Watch, Apple TV. Dlouho si říkam, zda by pro me nebyl i MacOS. Předchozí tři pokusy byli neuspěšné, na Mac se mi nepodařilo přejít. Ted to zkouším po čtvrté.
  content: |
    Chci si koupit Mac. Uz po čtvrté jej testuji. Mam iPhone, iPad, Apple Watch, Apple TV. Dlouho si říkam, zda by pro me nebyl i MacOS. Předchozí tři pokusy byli neuspěšné, na Mac se mi nepodařilo přejít. Ted to zkouším po čtvrté.

    Chtěl bych zjistit zda to půjde. Začnu tím, proč bych na Mac přešel. Nebudu teď řešit cenu, ta je sice vyšší, ale jsem ochotny ji zaplatit.

    ### Výhody Macu
    - Synchronizace mezi zařízeními &#8211; Telefon, Počítač
    - Funkční tiskárny, wifi, projektor, &#8230;
    - Unifikované klávesové zkratky (skrz aplikace, skrz zařízení)
    - Hotspot

    ### Výhody Debianu s i3
    - Efektivní window manger (i3)
    - Nativní Docker
    - Mnohem větší výkon za lepší cenu

    ### Nevýhody Macu
    - Naprosto strašná práce s okny klávesnici
    - Minimální velikost oken

    ### Nevýhody Debianu s i3
    - Připojení monitoru
    - Tiskárny

    #### Window Manager i3

    Tohle je asi nejdůležitější věc, proč jsem nikdy nepřešel na Mac. i3 je prostě naprosto dokonalý, skvěle se ovládá, perfektně pracuje s více monitory. Nemám k němu žádnou výhradu.

    #### Wifi Hotspot
    Na Macu je skvěle sdílení internetu z iPhone a iPadu do Macu. Otevřu Mac, kliknu na ikonu Wifi a vyberu si, zda chci internet z telefonu nebo iPadu. Nemusím nic vyndávat z kapes a pouštět hotspot. Prostě to funguje.

- id: emaily-v-jedne-domene-na-google-i-na-svem-serveru
  url: /blog/2019/emaily-v-jedne-domene-na-google-i-na-svem-serveru
  title: Emaily v jedné doméně na Google i na svém serveru
  date: 10. 1. 2019
  perex: |
    Chci si koupit Mac. Už potřetí jej testuji. Mám iPhone, iPad, Apple Watch, Apple TV. Dlouho si říkám, zda by pro mě nebyl i MacOS. Předchozí dva pokusy byly neúspěšné, na Mac se mi nepodařilo přejít. Teď to zkouším potřetí.
  content: |
    Je možné mít emaily v jedné doméně jako ondrej@example.com na G Suite a monitoring@example.com na svém serverů? Ano, jde a není to těžké.

    Používám G Suite z mnoha důvodů. Je to stabilní email, který funguje i když zbytek mé infrastruktury spadne, doručuje se do inboxu a nemusím řešit spam listy, mám na Google kalendář, kontakty a G Suite. To jsou asi hlavní důvody, proč jej používám.

    Na druhou stranu, email účet stojí 4 EUR měsíčně a poštu si organizuji do více účtů. Dělám to zase z více důvodů. Dobře se mi s tím pracuje a některé emaily chci sdílet a některé ne. Nechci také stahovat všechny emaily na mobilu, zvlášť ty, které nemusím řešit akutně a chodí jich hodně. Stejně tak mi vadí filtrování Googlim způsobem narozdíl od standartniho Sieve. Není to možná nejlepší způsob, ale mě vyhovuje.

    Dejme tomu, že používám doménu example.com. Používat email ondrej@example.com jako hlavní, ondrejsika@example.com na většinu služeb a webu (jako například ondrejsika+alza@example.com nebo ondrejsika+netflix@example.com), monitoring@example.com pro notifikace z monitoringu, wp@example.com pro notifikace z Worpresu a podobně.

    Jelikož Google chce za každý účet v G Suite 4 EUR, platil bych zbytečně moc za služby, které nechci. U těchto emailů nemusím řešit ani spam, většinou z nich nic neposílám.

    Moje dosavadní řešení bylo na svém serveru mít doménu int.example.com (int jako internal) a na ní mít tyto emaily (například ondrejsika@int.example.com, wp@int.example.com).

    Toto řešení se mi nakonec přestalo líbit. Povedlo se mi totiž docílit toho, že emaily mohu mít v hezkém formátu (ondrejsika@example.com, wp@example.com) a nepoužívat více účtů v G Suite. Ukážu Vám, jak na to.

    Provozuji vlastní emailový server Poste.io. Je to jeden Docker kontejner, který obsahuje SMTP, IMAP, webmail a Admin. Vytvořili to češi, je to fakt super. V něm jsem si vytvořil virtuální doménu example.com, na které si vytvářím jednotlivé účty. Dále jsem si vytvořil doménu gin.example.com (Google INput, podobnost s alkoholem náhodná), kterou jsem přesměroval na example.com, což znamená, že všechny emaily pro účty na gin.example.com se budou doručovat do schránek v doméně example.com. Používá se to například, když máte alias domény s pomlčkou a chcete doručovat emaily na obě domény (například ondrej@my-domain.com -> ondrej@mydomain.com, alice@my-domain.com -> alice@mydomain.com).

    MX DNS záznamy domény example.com nechám na Google a MX pro gin.example.com nastavím na můj mailserver. Vypadá to asi takto:

        sika@sika-x250:~$ host example.com
        example.com mail is handled by 10 aspmx.l.google.com.
        example.com mail is handled by 20 alt1.aspmx.l.google.com.
        sika@sika-x250:~$ host gin.example.com
        gin.example.com mail is handled by 10 mail.example.com.
        sika@sika-x250:~$

    V G Suite nastavím mému uživateli aliasy pro tyto jména (ondrejsika@example.com, wp@example.com) nebo doménový koš (akceptuje všechny emaly (cokoliv@example.com). Potom nastavím přesměrování těchto emailu na emaily v gin.example.com doméně, (která je interně doručuje na example.com). Poste.io nedělá DNS resilution pro domény, se kterými pracuje a proto se nepodívá, že example.com má být na Google, ale email doručí lokálnímu účtu. A to je celé. Stačí přidat nové emaily do mailového klienta.

    Pokud mám správně nastavené SPF, mohu emaily z domény i odesílat a ano, budou ve složce odeslaná pošta.
- id: talk-gitlab-ci-docker-linux-days-2018
  url: /blog/2018/talk-gitlab-ci-docker-linux-days-2018
  title: |
    Talk: Gitlab CI + Docker (Linux Days 2018)
  date: 6. 10. 2018
  ad: gitlab-ci
  perex: |
    Slidy k přednášce a workshopu na Linux Days 2018.
  content: |
    DOPLNIT SLIDY
    Repozitar: https://github.com/ondrejsika/linuxdays2018
    Resources:

    Setup of Gitlab Runner in Docker: [https://github.com/ondrejsika/gitlab-ci-runner](https://github.com/ondrejsika/gitlab-ci-runner)
    Run Traefik with SSL: [https://github.com/ondrejsika/traefik-ssl](https://github.com/ondrejsika/traefik-ssl)
    Docker image ondrejsika/ci: [https://github.com/ondrejsika/ondrejsika-ci-docker](https://github.com/ondrejsika/ondrejsika-ci-docker)
- id: talk-uvod-do-pouzivani-dockeru-teched-2018
  url: /blog/2019/talk-uvod-do-pouzivani-dockeru-teched-2018
  ad: docker
  title: |
    Talk: Úvod do používání Dockeru, TechEd 2018
  date: 16. 5. 2018
  perex: |
    Slidy a zdrojáky z mé přednášky na konferenci TechEd 2018.
  content: |
    DOPLNIT SLIDY

    Demo: https://github.com/ondrejsika/teched18
    Slides: https://speakerdeck.com/ondrejsika/teched-2018-introduction-to-docker
- id: talk-automatizace-pomoci-gitlab-gi-a-dockeru
  url: /blog/2018/talk-automatizace-pomoci-gitlab-gi-a-dockeru
  title: |
    Talk: Automatizace pomocí Gitlab CI a Dockeru
  date: 21. 4. 2018
  perex: Slides z přednášky na DevHeaven.
  content: |
    Zdroje:
    - [https://github.com/ondrejsika/jekyll-demo](https://github.com/ondrejsika/jekyll-demo)
    - [https://github.com/ondrejsika/traefik-ssl](https://github.com/ondrejsika/traefik-ssl)
    - [https://github.com/ondrejsika/gitlab-ci-runner](https://github.com/ondrejsika/gitlab-ci-runner)
    - [https://github.com/ondrejsika/ondrejsika-ci-docker](https://github.com/ondrejsika/ondrejsika-ci-docker)

    Mate zajem o skoleni [Dockeru](/), [Gitu](/) nebo [CI](/)?

- id: plzensky-barcamp-lightning-network-aneb-bitcoin-2.0
  url: .blog/2018/plzensky-barcamp-lightning-network-aneb-bitcoin-2.0
  title: |
    Plzensky Barcamp: Lightning Network aneb Bitcoin 2.0
  date: 7. 4. 2018
  perex: |
    Slidy a zdrojáky k demo ukázce LN na Plzeňském Barcampu.
  content: |
    Slides a zdrojáky k demo ukázce LN na Plzeňském Barcampu.
    Zdrojové kódy ukázky:  [https://github.com/ondrejsika/lightning-example](https://github.com/ondrejsika/lightning-example)
    Slides v PDF: [https://speakerd.s3.amazonaws.com/…/Lightning_Network_aneb_Bitcoin_2.0.pdf](https://speakerd.s3.amazonaws.com/…/Lightning_Network_aneb_Bitcoin_2.0.pdf)

    DOPLNIT SLIDY

- id: tunelovani-git-konfigurace-na-server-prez-ssh-aneb-konec-commitum-root-root@debian
  url: /blog/2018/tunelovani-git-konfigurace-na-server-prez-ssh-aneb-konec-commitum-root-root@debian
  title: Tunelovani GIT konfigurace na server prez SSH aneb konec commitum root root@debian
  date: 21. 3. 2018
  ad: git
  perex: |
    Určitě se vám někdy stalo, že jste něco commitovali na serveru a do historie jste si zavlekly něco jako: commit 8f160534070012c87c409e5b19028ad0062f0310 Author: root <root@debian> Date: Wed Jun 26 17:16:31 2013 +0000 blocks.pickle, peers.pickle added to .gitignore commit 96e83891bfdcad41c545220e1957fba1ba72c2cd Author: root&#8230;
  content: |
    Urcite se vam nekdy stalo, ze jste neco commitovali na serveru a do historie jste si zavlekly neco jako:

    ```
    commit 8f160534070012c87c409e5b19028ad0062f0310
    Author: root <root@debian>
    Date: Wed Jun 26 17:16:31 2013 +0000
    blocks.pickle, peers.pickle added to .gitignore
    ```
    Asi to znate. Ale nastavit uzivatele a email na serveru neni nejlepsi reseni, protoze muze pristupovat vice lidi a kazdy chce vytvaret commity pod svym jmenem.

    ### SSH forward proměnných
    Resenim muze byt posilani environment promenych po SSH. Vyzaduje to sice zmenu nastaveni SSH serveru, ale je to jediny zpusob, jak nastavit prostredi Gitu automaticky pro konkretniho uzivatele.
    #### Na lokalnim pocitaci
    Na straně klienta musíme mít v bashrc vyexportované proměnné, které nastavují v Gitu jméno a email pro autora i commitera. Jsou to tyto proměnné:

        export GIT_AUTHOR_NAME="Ondrej Sika"
        export GIT_AUTHOR_EMAIL="ondrej@ondrejsika.com"
        export GIT_COMMITTER_NAME=$GIT_AUTHOR_NAME
        export GIT_COMMITTER_EMAIL=$GIT_AUTHOR_EMAIL

    a je jestě nutné tyto proměnné posílat při SSH spojení. To se dá globálně povolit v SSH konfigu (.ssh/config) takto:
        Host *
            SendEnv GIT_*
    A to je na straně klienta vše.
    #### Na serveru
    Na serverů je nutné povolit přijímání env proměnných Gitu. Do souboru /etc/ssh/sshd_config je nutné přidat následující řádku:
    ```
    AcceptEnv GIT_*
    ```
    A pak jen restartovat SSH server (service ssh restart), odpojit a připojit se znovu. Zda vše zafungovalo, zjistíte když si vypíšete proměnné prostředí pomocí:
    ```
    root@debian:~# env | grep GIT
    GIT_COMMITTER_NAME=Ondrej Sika
    GIT_COMMITTER_EMAIL=ondrej@ondrejsika.com
    GIT_AUTHOR_NAME=Ondrej Sika
    GIT_AUTHOR_EMAIL=ondrej@ondrejsika.com
    ```
    Ted uz vse funguje, dalsi commit na serveru bude uz se spravnym autorem.

- id: python-libraries-for-bitcoin-and-ethereum-pycon-sk-2018
  url: /blog/2018/python-libraries-for-bitcoin-and-ethereum-pycon-sk-2018
  title: Python Libraries for Bitcoin and Ethereum (PyCon SK 2018)
  date: 10. 3. 2018
  perex: |
    Slidy z přednášky o knihovnách pro práci s Bitcoinem a Ethereem z PyCon SK 2018
  content: |
    Slidy z přednášky o knihovnách pro práci s Bitcoinem a Ethereem z PyCon SK 2018

    VLOZIT SLIDY

    Code examples: [https://github.com/ondrejsika/examples–bitcoin-ethereum-python-tools](https://github.com/ondrejsika/examples–bitcoin-ethereum-python-tools)

    Slides in PDF: [PDF](/)

- id: i3–tiling-window-manager-install-fest-2018
  url: /blog/2018/i3–tiling-window-manager-install-fest-2018
  title: i3 – tiling window manager (Install Fest 2018)
  date: 3. 3. 2018
  perex: |
    Slidy z mé přednášky o i3 windows manageru.
  content: |
    Slidy z mé přednášky o i3 windows manageru.

    VLOZIT SLIDY

    My i3 config: https://github.com/ondrejsika/i3-config

    Slides: [https://speakerdeck.com/ondrejsika/i3-tiling-window-manager-install-fest-2018](https://speakerdeck.com/ondrejsika/i3-tiling-window-manager-install-fest-2018)<br/>
    Slides [PDF]: [https://speakerd.s3.amazonaws.com/…/Install_Fest_2018_-_i3wm.pdf](https://speakerd.s3.amazonaws.com/presentations/0b309db6aa8140fd897065dd25d04f61/Install_Fest_2018_-_i3wm.pdf)

- id: jake-knapp-sprint
  url: /blog/2018/jake-knapp-sprint
  title: |
    Jake Knapp: Sprint
  date: 18. 2. 2018
  perex: |
    Právě jsem dočetl knížku Sprint od lidí z Google Ventrures. Když jsem si knížku kupoval, myslel jsem si, že si kupuji návod, jak ryche udělat nějaký projekt. Ale o tom knížka vůbec není … Kniha Sprint popisuje, jak otestovat nápad…
  content: |
    Právě jsem dočetl knížku Sprint od lidí z Google Ventrures. Když jsem si knížku kupoval, myslel jsem si, že si kupuji návod, jak ryche udělat nějaký projekt. Ale o tom knížka vůbec není …<br/>

    Kniha Sprint popisuje, jak otestovat nápad za týden. A nápad může být jakkoliv bláznivý. Vlastně, čím bláznivější, tím je to téma vhodnější pro sprint. Riskuji vlastně jen týden a v pátek budu mít hmatatelné výsledky, zda můj projekt může fungovat či nikoliv.<br/>

    V knížce se dozvíte, jak nápad vhodně zvolit, jak na něm v teamu pracovat, vytvořit prototyp a vyzkoušet na zákaznících. Je nutná trocha představivosti, ale sprintem můžete testovat prakticky všechno. Od navržení prodejny nebo ordinace, přes software nebo weby až po hardwarové produkty.<br/>

    Mnohé techniky z knihy se dají použít i mimo týdenní sprint, třeba když potřebujete společně něco vymyslet. Jsou lepší metody než brainstorming – ten podle autorů vůbec nefunguje. Také kvalitiativní rozhovory se zákazníky jsou velmi zajímavá oblast.<br/>

    Už se těším až sprint nebo nějakou jeho část či upravenou variantu, (i když to příliš nedoporučuji) vyzkouším na nějakém reálném projektu. Přemýšlím i o použití ve skautském oddílu. Až si udělám osobní zkušenost se sprintem, jak ho popisují v knize, určitě o tom napíši.<br/>

    Rád knihu půjčím: [https://distlib.com/ondrejsika/169/](https://distlib.com/ondrejsika/169/)<br/>
    Nebo ji můžete zakoupit: [https://www.melvil.cz/kniha-sprint/](https://www.melvil.cz/kniha-sprint/)
- id: prednaska-o-dockeru-ve-zline-8-2-2018
  url: /blog/2018/prednaska-o-dockeru-ve-zline-8-2-2018
  ad: docker
  title: |
    Přednáška o Dockeru ve Zlíně 8. 2. 2018
  date: 8. 2. 2018
  perex: |
  content: |
- id: prednaska-o-dockeru-v-olomouci-30-1-2017
  url: /blog/2018/prednaska-o-dockeru-v-olomouci-30-1-2017
  title: |
    Přednáška o Dockeru v Olomouci 30. 11. 2017
  date: 30. 11. 2017
  perex: |
  content: |
